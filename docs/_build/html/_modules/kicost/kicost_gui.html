
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>kicost.kicost_gui &#8212; kicost 1.1.12 documentation</title>
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/classic.css" type="text/css" />
    
    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">kicost 1.1.12 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" accesskey="U">Module code</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">kicost.kicost_gui</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for kicost.kicost_gui</h1><div class="highlight"><pre>
<span></span><span class="c1"># -*- coding: utf-8 -*-</span>

<span class="c1"># MIT license</span>
<span class="c1">#</span>
<span class="c1"># Copyright (C) 2018 by XESS Corporation / Hildo Guillardi Júnior</span>
<span class="c1">#</span>
<span class="c1"># Permission is hereby granted, free of charge, to any person obtaining a copy</span>
<span class="c1"># of this software and associated documentation files (the &quot;Software&quot;), to deal</span>
<span class="c1"># in the Software without restriction, including without limitation the rights</span>
<span class="c1"># to use, copy, modify, merge, publish, distribute, sublicense, and/or sell</span>
<span class="c1"># copies of the Software, and to permit persons to whom the Software is</span>
<span class="c1"># furnished to do so, subject to the following conditions:</span>
<span class="c1">#</span>
<span class="c1"># The above copyright notice and this permission notice shall be included in</span>
<span class="c1"># all copies or substantial portions of the Software.</span>
<span class="c1">#</span>
<span class="c1"># THE SOFTWARE IS PROVIDED &quot;AS IS&quot;, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR</span>
<span class="c1"># IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,</span>
<span class="c1"># FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE</span>
<span class="c1"># AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER</span>
<span class="c1"># LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,</span>
<span class="c1"># OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN</span>
<span class="c1"># THE SOFTWARE.</span>

<span class="c1"># Author information.</span>
<span class="n">__author__</span> <span class="o">=</span> <span class="s1">&#39;Hildo Guillardi Júnior&#39;</span>
<span class="n">__webpage__</span> <span class="o">=</span> <span class="s1">&#39;https://github.com/hildogjr/&#39;</span>
<span class="n">__company__</span> <span class="o">=</span> <span class="s1">&#39;University of Campinas - Brazil&#39;</span>

<span class="kn">from</span> <span class="nn">.global_vars</span> <span class="kn">import</span> <span class="p">(</span><span class="n">wxPythonNotPresent</span><span class="p">,</span> <span class="n">PLATFORM_MACOS_STARTS_WITH</span><span class="p">,</span> <span class="n">PLATFORM_LINUX_STARTS_WITH</span><span class="p">,</span> <span class="n">PLATFORM_WINDOWS_STARTS_WITH</span><span class="p">,</span>
                          <span class="n">W_LOCFAIL</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">KiCostError</span>

<span class="c1"># Libraries.</span>
<span class="k">try</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">wx</span>  <span class="c1"># wxWidgets for Python.</span>
    <span class="n">wx_old</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">__version__</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">&lt;=</span> <span class="mi">3</span>
<span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
    <span class="k">raise</span> <span class="n">wxPythonNotPresent</span><span class="p">()</span>
<span class="kn">import</span> <span class="nn">webbrowser</span>  <span class="c1"># To update informations.</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">subprocess</span>  <span class="c1"># To access OS commands and run in the shell.</span>
<span class="kn">from</span> <span class="nn">threading</span> <span class="kn">import</span> <span class="n">Thread</span>
<span class="kn">import</span> <span class="nn">time</span>  <span class="c1"># To elapse time.</span>
<span class="kn">import</span> <span class="nn">tempfile</span>  <span class="c1"># To create the temporary log file.</span>
<span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span>  <span class="c1"># To create the log name, when asked to save.</span>
<span class="kn">from</span> <span class="nn">distutils.version</span> <span class="kn">import</span> <span class="n">StrictVersion</span>  <span class="c1"># To comparative of versions.</span>
<span class="kn">from</span> <span class="nn">traceback</span> <span class="kn">import</span> <span class="n">format_tb</span>
<span class="kn">import</span> <span class="nn">re</span>  <span class="c1"># Regular expression parser.</span>
<span class="kn">import</span> <span class="nn">locale</span>
<span class="kn">from</span> <span class="nn">.currency_converter</span> <span class="kn">import</span> <span class="n">list_currencies</span><span class="p">,</span> <span class="n">get_currency_symbol</span><span class="p">,</span> <span class="n">get_currency_name</span>
<span class="kn">import</span> <span class="nn">requests</span>

<span class="c1"># KiCost libraries.</span>
<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="p">(</span><span class="n">__version__</span><span class="p">,</span> <span class="n">info</span><span class="p">,</span> <span class="n">error</span><span class="p">,</span> <span class="n">warning</span><span class="p">,</span> <span class="n">debug_overview</span><span class="p">,</span> <span class="n">debug_general</span><span class="p">,</span> <span class="n">get_logger</span><span class="p">,</span> <span class="n">is_debug_obsessive</span><span class="p">,</span> <span class="n">is_debug_overview</span><span class="p">,</span>
               <span class="n">debug_obsessive</span><span class="p">)</span>  <span class="c1"># Version control by @xesscorp and collaborator.</span>
<span class="kn">from</span> <span class="nn">.kicost</span> <span class="kn">import</span> <span class="n">kicost</span><span class="p">,</span> <span class="n">output_filename</span>  <span class="c1"># kicost core functions.</span>
<span class="kn">from</span> <span class="nn">.distributors</span> <span class="kn">import</span> <span class="n">init_distributor_dict</span><span class="p">,</span> <span class="n">get_distributors_iter</span><span class="p">,</span> <span class="n">get_distributor_info</span><span class="p">,</span> <span class="n">get_dist_name_from_label</span><span class="p">,</span> <span class="n">set_distributors_progress</span>
<span class="kn">from</span> <span class="nn">.edas</span> <span class="kn">import</span> <span class="n">file_eda_match</span><span class="p">,</span> <span class="n">get_registered_eda_names</span><span class="p">,</span> <span class="n">get_eda_label</span><span class="p">,</span> <span class="n">get_registered_eda_labels</span>
<span class="kn">from</span> <span class="nn">.log</span> <span class="kn">import</span> <span class="n">CustomFormatter</span>
<span class="n">py_2</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">version_info</span> <span class="o">&lt;</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="k">if</span> <span class="n">sys</span><span class="o">.</span><span class="n">platform</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;win32&quot;</span><span class="p">):</span>
    <span class="kn">from</span> <span class="nn">.os_windows</span> <span class="kn">import</span> <span class="n">reg_enum_keys</span><span class="p">,</span> <span class="n">reg_get</span>
    <span class="k">if</span> <span class="n">py_2</span><span class="p">:</span>
        <span class="kn">from</span> <span class="nn">_winreg</span> <span class="kn">import</span> <span class="n">HKEY_LOCAL_MACHINE</span>
        <span class="n">ConnectRegistryError</span> <span class="o">=</span> <span class="ne">WindowsError</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="kn">from</span> <span class="nn">winreg</span> <span class="kn">import</span> <span class="n">HKEY_LOCAL_MACHINE</span>
        <span class="n">ConnectRegistryError</span> <span class="o">=</span> <span class="ne">PermissionError</span>  <span class="c1"># noqa: F821</span>

<span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;kicost_gui&#39;</span><span class="p">]</span>  <span class="c1"># , &#39;kicost_gui_runterminal&#39;</span>
<span class="c1"># TODO this variable was used locally and referred globally</span>
<span class="n">libreoffice_executable</span> <span class="o">=</span> <span class="kc">None</span>

<span class="c1"># =================================</span>
<span class="c1"># Guide definitions.</span>

<span class="c1"># Open file definitions.</span>
<span class="n">FILE_HIST_QTY_DEFAULT</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">SEP_FILES</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>  <span class="c1"># File separator in the comboBox.</span>
<span class="n">WILDCARD_BOM</span> <span class="o">=</span> <span class="s2">&quot;BOM compatible formats (*.xml,*.csv)|*.xml;*.csv|&quot;</span>\
            <span class="s2">&quot;KiCad/Altium BOM file (*.xml)|*.xml|&quot;</span> \
            <span class="s2">&quot;Proteus/Generic BOM file (*.csv)|*.csv&quot;</span>

<span class="c1"># save settings definitions.</span>
<span class="n">CONFIG_FILE</span> <span class="o">=</span> <span class="s1">&#39;KiCost&#39;</span>  <span class="c1"># Config file for Linux and Windows registry key for KiCost configurations.</span>
<span class="n">GUI_SIZE_ENTRY</span> <span class="o">=</span> <span class="s1">&#39;GUI_size&#39;</span>
<span class="n">GUI_POSITION_ENTRY</span> <span class="o">=</span> <span class="s1">&#39;GUI_position&#39;</span>
<span class="n">GUI_NEWS_MESSAGE_ENTRY</span> <span class="o">=</span> <span class="s1">&#39;GUI_news_message&#39;</span>

<span class="c1"># Links displayed.</span>
<span class="n">PAGE_OFFICIAL</span> <span class="o">=</span> <span class="s1">&#39;https://hildogjr.github.io/KiCost/&#39;</span>
<span class="n">PAGE_UPDATE</span> <span class="o">=</span> <span class="s1">&#39;https://pypi.python.org/pypi/kicost&#39;</span>  <span class="c1"># Page with the last official version.</span>
<span class="c1"># https://github.com/hildogjr/KiCost/blob/master/kicost/version.py</span>
<span class="n">PAGE_DEV</span> <span class="o">=</span> <span class="s1">&#39;https://github.com/hildogjr/KiCost/issues/&#39;</span>
<span class="n">PAGE_POWERED_BY</span> <span class="o">=</span> <span class="s1">&#39;https://kitspace.org/&#39;</span>

<span class="n">kicostPath</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="vm">__file__</span><span class="p">))</span>  <span class="c1"># Application dir.</span>


<span class="c1"># ======================================================================</span>
<span class="k">class</span> <span class="nc">ResultEvent</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">PyEvent</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Simple event to carry arbitrary result data.&quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">id</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Init Result Event.&quot;&quot;&quot;</span>
        <span class="n">wx</span><span class="o">.</span><span class="n">PyEvent</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">SetEventType</span><span class="p">(</span><span class="nb">id</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span>


<span class="c1"># ======================================================================</span>
<span class="k">class</span> <span class="nc">KiCostThread</span><span class="p">(</span><span class="n">Thread</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Helper class to safetly call the run action &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">wxObject</span><span class="p">,</span> <span class="n">event_id</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Init Worker Thread Class.&quot;&quot;&quot;</span>
        <span class="n">Thread</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">args</span> <span class="o">=</span> <span class="n">args</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">wxObject</span> <span class="o">=</span> <span class="n">wxObject</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">event_id</span> <span class="o">=</span> <span class="n">event_id</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">daemon</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Run KiCost and post stuff, but don&#39;t touch the GUI in a direct way &quot;&quot;&quot;</span>
        <span class="n">args</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span>
        <span class="c1"># Run KiCost main function and print in the log the elapsed time.</span>
        <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
        <span class="n">info</span><span class="p">(</span><span class="s1">&#39;Starting cost processing ...&#39;</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">is_debug_obsessive</span><span class="p">():</span>
                <span class="n">debug_general</span><span class="p">(</span><span class="s1">&#39;Arguments for kicost: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">))</span>
            <span class="n">kicost</span><span class="p">(</span><span class="n">in_file</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">input</span><span class="p">,</span> <span class="n">eda_name</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">eda_name</span><span class="p">,</span>
                   <span class="n">out_filename</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">output</span><span class="p">,</span> <span class="n">collapse_refs</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">collapse_refs</span><span class="p">,</span>
                   <span class="n">user_fields</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">fields</span><span class="p">,</span> <span class="n">ignore_fields</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">ignore_fields</span><span class="p">,</span>
                   <span class="n">group_fields</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">group_fields</span><span class="p">,</span> <span class="n">translate_fields</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">translate_fields</span><span class="p">,</span>
                   <span class="n">variant</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">variant</span><span class="p">,</span>
                   <span class="n">dist_list</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">include</span><span class="p">,</span> <span class="n">currency</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">currency</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">KiCostError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">error</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
            <span class="c1"># We are done, notify the main thread</span>
            <span class="n">wx</span><span class="o">.</span><span class="n">PostEvent</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">wxObject</span><span class="p">,</span> <span class="n">ResultEvent</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">event_id</span><span class="p">))</span>
            <span class="k">return</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">is_debug_overview</span><span class="p">():</span>
                <span class="c1"># Inform a traceback</span>
                <span class="p">(</span><span class="nb">type</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">traceback</span><span class="p">)</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">exc_info</span><span class="p">()</span>
                <span class="n">trace</span> <span class="o">=</span> <span class="n">format_tb</span><span class="p">(</span><span class="n">traceback</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">trace</span><span class="p">:</span>
                    <span class="n">info</span><span class="p">(</span><span class="n">line</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
            <span class="n">error</span><span class="p">(</span><span class="s1">&#39;Internal error: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
            <span class="c1"># We are done, notify the main thread</span>
            <span class="n">wx</span><span class="o">.</span><span class="n">PostEvent</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">wxObject</span><span class="p">,</span> <span class="n">ResultEvent</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">event_id</span><span class="p">))</span>
            <span class="k">return</span>
        <span class="k">finally</span><span class="p">:</span>
            <span class="n">init_distributor_dict</span><span class="p">()</span>  <span class="c1"># Restore distributors modified during the execution of KiCost motor.</span>
        <span class="n">debug_overview</span><span class="p">(</span><span class="s1">&#39;Elapsed time: </span><span class="si">{}</span><span class="s1"> seconds&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span><span class="p">))</span>
        <span class="n">info</span><span class="p">(</span><span class="s1">&#39;Finished cost processing.&#39;</span><span class="p">)</span>
        <span class="c1"># Convert to ODS</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">args</span><span class="o">.</span><span class="n">convert_to_ods</span><span class="p">:</span>
                <span class="n">debug_overview</span><span class="p">(</span><span class="s1">&#39;Converting </span><span class="se">\&#39;</span><span class="si">{}</span><span class="se">\&#39;</span><span class="s1"> to ODS file...&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">output</span><span class="p">)))</span>
                <span class="n">subprocess</span><span class="o">.</span><span class="n">run</span><span class="p">((</span><span class="n">libreoffice_executable</span><span class="p">,</span> <span class="s1">&#39;--headless&#39;</span><span class="p">,</span> <span class="s1">&#39;--convert-to&#39;</span><span class="p">,</span> <span class="s1">&#39;ods&#39;</span><span class="p">,</span> <span class="n">args</span><span class="o">.</span><span class="n">output</span><span class="p">,</span>
                                <span class="s1">&#39;--outdir&#39;</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">output</span><span class="p">)),</span> <span class="n">check</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="c1"># os.remove(args.output)  # Delete the older file.</span>
                <span class="n">args</span><span class="o">.</span><span class="n">output</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">output</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;.ods&#39;</span>
        <span class="k">except</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">CalledProcessError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">debug_overview</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\&#39;</span><span class="si">{}</span><span class="se">\&#39;</span><span class="s1"> could be not converted to ODS: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">output</span><span class="p">),</span> <span class="n">e</span><span class="p">))</span>
            <span class="k">pass</span>
        <span class="c1"># Open the spreadsheet</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">args</span><span class="o">.</span><span class="n">open_spreadsheet</span><span class="p">:</span>
                <span class="n">debug_overview</span><span class="p">(</span><span class="s1">&#39;Opening the output file </span><span class="se">\&#39;</span><span class="si">{}</span><span class="se">\&#39;</span><span class="s1">...&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">output</span><span class="p">)))</span>
                <span class="n">open_file</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">output</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">debug_overview</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\&#39;</span><span class="si">{}</span><span class="se">\&#39;</span><span class="s1"> could be not opened: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">output</span><span class="p">),</span> <span class="n">e</span><span class="p">))</span>
        <span class="c1"># We are done, notify the main thread</span>
        <span class="n">wx</span><span class="o">.</span><span class="n">PostEvent</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">wxObject</span><span class="p">,</span> <span class="n">ResultEvent</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">event_id</span><span class="p">))</span>


<span class="c1"># ======================================================================</span>
<span class="k">def</span> <span class="nf">open_file</span><span class="p">(</span><span class="n">filepath</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;@brief Open a file with the default application in different OSs.</span>
<span class="sd">       @param filepath str() file name.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">if</span> <span class="n">sys</span><span class="o">.</span><span class="n">platform</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">PLATFORM_MACOS_STARTS_WITH</span><span class="p">):</span>  <span class="c1"># Mac-OS.</span>
        <span class="n">subprocess</span><span class="o">.</span><span class="n">call</span><span class="p">((</span><span class="s1">&#39;open&#39;</span><span class="p">,</span> <span class="n">filepath</span><span class="p">))</span>
    <span class="k">elif</span> <span class="n">sys</span><span class="o">.</span><span class="n">platform</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">PLATFORM_WINDOWS_STARTS_WITH</span><span class="p">):</span>  <span class="c1"># Windows.</span>
        <span class="n">os</span><span class="o">.</span><span class="n">startfile</span><span class="p">(</span><span class="n">filepath</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">sys</span><span class="o">.</span><span class="n">platform</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">PLATFORM_LINUX_STARTS_WITH</span><span class="p">):</span>  <span class="c1"># Linux.</span>
        <span class="n">subprocess</span><span class="o">.</span><span class="n">call</span><span class="p">((</span><span class="s1">&#39;xdg-open&#39;</span><span class="p">,</span> <span class="n">filepath</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">info</span><span class="p">(</span><span class="s1">&#39;Not recognized OS. The spreadsheet file will not be automatically opened.&#39;</span><span class="p">)</span>


<span class="c1"># ======================================================================</span>
<span class="k">class</span> <span class="nc">FileDropTarget</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">FileDropTarget</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39; This object implements Drop Target functionality for Files.</span>
<span class="sd">        @param Window handle.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39; @brief Constructor.&#39;&#39;&#39;</span>
        <span class="n">wx</span><span class="o">.</span><span class="n">FileDropTarget</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">obj</span> <span class="o">=</span> <span class="n">obj</span>

    <span class="k">def</span> <span class="nf">OnDropFiles</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">filenames</span><span class="p">):</span>
        <span class="c1"># self.obj.SetInsertionPointEnd()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">addFile</span><span class="p">(</span><span class="n">filenames</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">True</span>  <span class="c1"># No error.</span>


<span class="c1"># ======================================================================</span>
<span class="k">class</span> <span class="nc">menuSelection</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">Menu</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39; @brief Menu of the distributor checkbox list. Provide select all, unselect and toggle hotkey.</span>
<span class="sd">        @param TextBox handle.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39; @brief Constructor.&#39;&#39;&#39;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">menuSelection</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">list</span> <span class="o">=</span> <span class="n">parent</span>

        <span class="n">mmi</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">NewId</span><span class="p">(),</span> <span class="s1">&#39;Select &amp;all&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_MENU</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">selectAll</span><span class="p">,</span> <span class="n">mmi</span><span class="p">)</span>

        <span class="n">mmi</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">NewId</span><span class="p">(),</span> <span class="s1">&#39;&amp;Unselect all&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_MENU</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">unselectAll</span><span class="p">,</span> <span class="n">mmi</span><span class="p">)</span>

        <span class="n">mmi</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">NewId</span><span class="p">(),</span> <span class="s1">&#39;&amp;Toggle&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_MENU</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toggleAll</span><span class="p">,</span> <span class="n">mmi</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">selectAll</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39; @brief Select all distributor that exist.&#39;&#39;&#39;</span>
        <span class="n">event</span><span class="o">.</span><span class="n">Skip</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">list</span><span class="o">.</span><span class="n">GetCount</span><span class="p">()):</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">list</span><span class="o">.</span><span class="n">IsChecked</span><span class="p">(</span><span class="n">idx</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">list</span><span class="o">.</span><span class="n">Check</span><span class="p">(</span><span class="n">idx</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">unselectAll</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39; @brief Unselect all distributor that exist.&#39;&#39;&#39;</span>
        <span class="n">event</span><span class="o">.</span><span class="n">Skip</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">list</span><span class="o">.</span><span class="n">GetCount</span><span class="p">()):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">list</span><span class="o">.</span><span class="n">IsChecked</span><span class="p">(</span><span class="n">idx</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">list</span><span class="o">.</span><span class="n">Check</span><span class="p">(</span><span class="n">idx</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">toggleAll</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39; @brief Toggle all distributor that exist.&#39;&#39;&#39;</span>
        <span class="n">event</span><span class="o">.</span><span class="n">Skip</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">list</span><span class="o">.</span><span class="n">GetCount</span><span class="p">()):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">list</span><span class="o">.</span><span class="n">IsChecked</span><span class="p">(</span><span class="n">idx</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">list</span><span class="o">.</span><span class="n">Check</span><span class="p">(</span><span class="n">idx</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">list</span><span class="o">.</span><span class="n">Check</span><span class="p">(</span><span class="n">idx</span><span class="p">)</span>


<span class="c1"># ======================================================================</span>
<span class="k">class</span> <span class="nc">menuMessages</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">Menu</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39; @brief Menu of the messages text. Provide copy and save options.</span>
<span class="sd">        @param TextBox handle.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39; @brief Constructor.&#39;&#39;&#39;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">menuMessages</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parent</span> <span class="o">=</span> <span class="n">parent</span>

        <span class="n">mmi</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">NewId</span><span class="p">(),</span> <span class="s1">&#39;&amp;Purge&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_MENU</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">purgeMessages</span><span class="p">,</span> <span class="n">mmi</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">AppendSeparator</span><span class="p">()</span>

        <span class="n">mmi</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">NewId</span><span class="p">(),</span> <span class="s1">&#39;&amp;Copy to clipboard&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_MENU</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">copyMessages</span><span class="p">,</span> <span class="n">mmi</span><span class="p">)</span>

        <span class="n">mmi</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">NewId</span><span class="p">(),</span> <span class="s1">&#39;Cut to clip&amp;board&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_MENU</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">cutMessages</span><span class="p">,</span> <span class="n">mmi</span><span class="p">)</span>

        <span class="n">mmi</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">NewId</span><span class="p">(),</span> <span class="s1">&#39;&amp;Save&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_MENU</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">saveMessages</span><span class="p">,</span> <span class="n">mmi</span><span class="p">)</span>

        <span class="n">mmi</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">NewId</span><span class="p">(),</span> <span class="s1">&#39;S&amp;ave and clear&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_MENU</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">saveClearMessages</span><span class="p">,</span> <span class="n">mmi</span><span class="p">)</span>

        <span class="n">mmi</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">NewId</span><span class="p">(),</span> <span class="s1">&#39;&amp;Open externally&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_MENU</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">openMessages</span><span class="p">,</span> <span class="n">mmi</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">copyMessages</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39; @brief Copy the warning/error/log messages to clipboard.&#39;&#39;&#39;</span>
        <span class="n">event</span><span class="o">.</span><span class="n">Skip</span><span class="p">()</span>
        <span class="n">clipdata</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">TextDataObject</span><span class="p">()</span>
        <span class="n">clipdata</span><span class="o">.</span><span class="n">SetText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">m_textCtrl_messages</span><span class="o">.</span><span class="n">GetValue</span><span class="p">())</span>
        <span class="n">wx</span><span class="o">.</span><span class="n">TheClipboard</span><span class="o">.</span><span class="n">Open</span><span class="p">()</span>
        <span class="n">wx</span><span class="o">.</span><span class="n">TheClipboard</span><span class="o">.</span><span class="n">SetData</span><span class="p">(</span><span class="n">clipdata</span><span class="p">)</span>
        <span class="n">wx</span><span class="o">.</span><span class="n">TheClipboard</span><span class="o">.</span><span class="n">Close</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">cutMessages</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39; @brief Cut the warning/error/log messages to clipboard.&#39;&#39;&#39;</span>
        <span class="n">event</span><span class="o">.</span><span class="n">Skip</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">purgeMessages</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">copyMessages</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">purgeMessages</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39; @brief Clear message box.&#39;&#39;&#39;</span>
        <span class="n">event</span><span class="o">.</span><span class="n">Skip</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">m_textCtrl_messages</span><span class="o">.</span><span class="n">Clear</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">saveMessages</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39; @brief Save the messages as a text &quot;KiCost*.log&quot; file.&#39;&#39;&#39;</span>
        <span class="n">event</span><span class="o">.</span><span class="n">Skip</span><span class="p">()</span>
        <span class="n">actualDir</span> <span class="o">=</span> <span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">m_comboBox_files</span><span class="o">.</span><span class="n">GetValue</span><span class="p">()</span> <span class="k">else</span>
                     <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">m_comboBox_files</span><span class="o">.</span><span class="n">GetValue</span><span class="p">())))</span>
        <span class="n">dlg</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">FileDialog</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">,</span> <span class="n">message</span><span class="o">=</span><span class="s2">&quot;Save log as...&quot;</span><span class="p">,</span>
            <span class="n">defaultDir</span><span class="o">=</span><span class="n">actualDir</span><span class="p">,</span>
            <span class="n">defaultFile</span><span class="o">=</span><span class="s2">&quot;KiCost &quot;</span> <span class="o">+</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1"> %Hh%Mmin%Ss&#39;</span><span class="p">),</span>
            <span class="n">wildcard</span><span class="o">=</span><span class="s2">&quot;Log file (*.log)|*.log&quot;</span><span class="p">,</span>
            <span class="n">style</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">FD_SAVE</span> <span class="o">|</span> <span class="n">wx</span><span class="o">.</span><span class="n">FD_OVERWRITE_PROMPT</span>
           <span class="p">)</span>
        <span class="n">dlg</span><span class="o">.</span><span class="n">SetFilterIndex</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">dlg</span><span class="o">.</span><span class="n">ShowModal</span><span class="p">()</span> <span class="o">==</span> <span class="n">wx</span><span class="o">.</span><span class="n">ID_OK</span><span class="p">:</span>
            <span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">dlg</span><span class="o">.</span><span class="n">GetPath</span><span class="p">(),</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">m_textCtrl_messages</span><span class="o">.</span><span class="n">GetValue</span><span class="p">())</span>
            <span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
            <span class="n">wx</span><span class="o">.</span><span class="n">MessageBox</span><span class="p">(</span><span class="s1">&#39;The log file as saved.&#39;</span><span class="p">,</span> <span class="s1">&#39;Info&#39;</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">OK</span> <span class="o">|</span> <span class="n">wx</span><span class="o">.</span><span class="n">ICON_INFORMATION</span><span class="p">)</span>
        <span class="n">dlg</span><span class="o">.</span><span class="n">Destroy</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">saveClearMessages</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;@brief Save the messages and clear the log in the guide.&#39;&#39;&#39;</span>
        <span class="n">event</span><span class="o">.</span><span class="n">Skip</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">saveMessages</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">purgeMessages</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">openMessages</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39; @brief Save the messages in a temporary file and open it in the default text editor before system delete.&#39;&#39;&#39;</span>
        <span class="n">event</span><span class="o">.</span><span class="n">Skip</span><span class="p">()</span>
        <span class="c1"># TODO - not working on Ubuntu</span>
        <span class="k">with</span> <span class="n">tempfile</span><span class="o">.</span><span class="n">NamedTemporaryFile</span><span class="p">(</span><span class="n">prefix</span><span class="o">=</span><span class="s1">&#39;KiCost_&#39;</span><span class="p">,</span> <span class="n">suffix</span><span class="o">=</span><span class="s1">&#39;.log&#39;</span><span class="p">,</span> <span class="n">delete</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">temp</span><span class="p">:</span>
            <span class="n">temp</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">m_textCtrl_messages</span><span class="o">.</span><span class="n">GetValue</span><span class="p">())</span>
            <span class="n">open_file</span><span class="p">(</span><span class="n">temp</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
            <span class="n">temp</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>


<span class="c1"># ======================================================================</span>
<span class="k">class</span> <span class="nc">formKiCost</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">Frame</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39; @brief Main frame / form of KiCost GUI.&#39;&#39;&#39;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39; @brief Constructor, code generated by wxFormBuilder tool.&#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="n">wx_old</span><span class="p">:</span>
            <span class="n">pre</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">PreFrame</span><span class="p">()</span>
            <span class="n">pre</span><span class="o">.</span><span class="n">Create</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">ID_ANY</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="sa">u</span><span class="s2">&quot;KiCost&quot;</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">DefaultPosition</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">Size</span><span class="p">(</span><span class="mi">446</span><span class="p">,</span> <span class="mi">351</span><span class="p">),</span> <span class="n">style</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">DEFAULT_FRAME_STYLE</span> <span class="o">|</span> <span class="n">wx</span><span class="o">.</span><span class="n">TAB_TRAVERSAL</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">PostCreate</span><span class="p">(</span><span class="n">pre</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">super</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">Frame</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">ID_ANY</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="sa">u</span><span class="s2">&quot;KiCost&quot;</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">DefaultPosition</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">Size</span><span class="p">(</span><span class="mi">446</span><span class="p">,</span> <span class="mi">351</span><span class="p">),</span>
                                           <span class="n">style</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">DEFAULT_FRAME_STYLE</span> <span class="o">|</span> <span class="n">wx</span><span class="o">.</span><span class="n">TAB_TRAVERSAL</span><span class="p">)</span>

        <span class="n">bSizer1</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">BoxSizer</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">VERTICAL</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">m_notebook1</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">Notebook</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">ID_ANY</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">DefaultPosition</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">DefaultSize</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_panel1</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">Panel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m_notebook1</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">ID_ANY</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">DefaultPosition</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">DefaultSize</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">TAB_TRAVERSAL</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_panel1</span><span class="o">.</span><span class="n">SetToolTip</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">ToolTip</span><span class="p">(</span><span class="sa">u</span><span class="s2">&quot;Basic controls, BOM selection and supported distributors.&quot;</span><span class="p">))</span>

        <span class="n">bSizer3</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">BoxSizer</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">VERTICAL</span><span class="p">)</span>

        <span class="n">sbSizer</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">StaticBoxSizer</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">StaticBox</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m_panel1</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">ID_ANY</span><span class="p">,</span> <span class="sa">u</span><span class="s2">&quot;BOM input files:&quot;</span><span class="p">),</span> <span class="n">wx</span><span class="o">.</span><span class="n">HORIZONTAL</span><span class="p">)</span>
        <span class="n">m_comboBox_filesChoices</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_comboBox_files</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">ComboBox</span><span class="p">(</span><span class="n">sbSizer</span><span class="o">.</span><span class="n">GetStaticBox</span><span class="p">(),</span> <span class="n">wx</span><span class="o">.</span><span class="n">ID_ANY</span><span class="p">,</span> <span class="sa">u</span><span class="s2">&quot;Not selected files&quot;</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">DefaultPosition</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">DefaultSize</span><span class="p">,</span>
                                            <span class="n">m_comboBox_filesChoices</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_comboBox_files</span><span class="o">.</span><span class="n">SetToolTip</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">ToolTip</span><span class="p">(</span><span class="sa">u</span><span class="s2">&quot;BOM(s) file(s) to scrape.</span><span class="se">\n</span><span class="s2">Click on the arrow to see/select one of the history files.&quot;</span><span class="p">))</span>
        <span class="n">sbSizer</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m_comboBox_files</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">ALL</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_comboBox_files</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_COMBOBOX</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_comboBox_files_selecthist</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_button_openfile</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="n">sbSizer</span><span class="o">.</span><span class="n">GetStaticBox</span><span class="p">(),</span> <span class="n">wx</span><span class="o">.</span><span class="n">ID_ANY</span><span class="p">,</span> <span class="sa">u</span><span class="s2">&quot;Choose BOM&quot;</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">DefaultPosition</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">DefaultSize</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_button_openfile</span><span class="o">.</span><span class="n">SetToolTip</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">ToolTip</span><span class="p">(</span><span class="sa">u</span><span class="s2">&quot;Click to choose the BOM(s) file(s).&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_button_openfile</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_BUTTON</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">button_openfile</span><span class="p">)</span>
        <span class="n">sbSizer</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m_button_openfile</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">ALL</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
        <span class="n">bSizer3</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="n">sbSizer</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">EXPAND</span> <span class="o">|</span> <span class="n">wx</span><span class="o">.</span><span class="n">TOP</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>

        <span class="n">sbSizer</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">StaticBoxSizer</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">StaticBox</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m_panel1</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">ID_ANY</span><span class="p">,</span> <span class="sa">u</span><span class="s2">&quot;Spreadsheet output file:&quot;</span><span class="p">),</span> <span class="n">wx</span><span class="o">.</span><span class="n">HORIZONTAL</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_text_saveas</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">TextCtrl</span><span class="p">(</span><span class="n">sbSizer</span><span class="o">.</span><span class="n">GetStaticBox</span><span class="p">(),</span> <span class="n">wx</span><span class="o">.</span><span class="n">ID_ANY</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">EmptyString</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">DefaultPosition</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">DefaultSize</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">TE_NOHIDESEL</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_text_saveas</span><span class="o">.</span><span class="n">SetToolTip</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">ToolTip</span><span class="p">(</span><span class="sa">u</span><span class="s2">&quot;Output spreadsheet file name.&quot;</span><span class="p">))</span>
        <span class="n">sbSizer</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m_text_saveas</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">ALL</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_button_saveas</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="n">sbSizer</span><span class="o">.</span><span class="n">GetStaticBox</span><span class="p">(),</span> <span class="n">wx</span><span class="o">.</span><span class="n">ID_ANY</span><span class="p">,</span> <span class="sa">u</span><span class="s2">&quot;Save as...&quot;</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">DefaultPosition</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">DefaultSize</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_button_saveas</span><span class="o">.</span><span class="n">SetToolTip</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">ToolTip</span><span class="p">(</span><span class="sa">u</span><span class="s2">&quot;Click to change the output spreadsheet file name.&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_button_saveas</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_BUTTON</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">button_saveas</span><span class="p">)</span>
        <span class="n">sbSizer</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m_button_saveas</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">ALL</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
        <span class="n">bSizer3</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="n">sbSizer</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">EXPAND</span> <span class="o">|</span> <span class="n">wx</span><span class="o">.</span><span class="n">TOP</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>

        <span class="n">bSizer4</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">BoxSizer</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">HORIZONTAL</span><span class="p">)</span>

        <span class="n">sbSizer3</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">StaticBoxSizer</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">StaticBox</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m_panel1</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">ID_ANY</span><span class="p">,</span> <span class="sa">u</span><span class="s2">&quot;Distributors to get price:&quot;</span><span class="p">),</span> <span class="n">wx</span><span class="o">.</span><span class="n">VERTICAL</span><span class="p">)</span>
        <span class="n">m_checkList_distChoices</span> <span class="o">=</span> <span class="p">[</span><span class="n">wx</span><span class="o">.</span><span class="n">EmptyString</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_checkList_dist</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">CheckListBox</span><span class="p">(</span><span class="n">sbSizer3</span><span class="o">.</span><span class="n">GetStaticBox</span><span class="p">(),</span> <span class="n">wx</span><span class="o">.</span><span class="n">ID_ANY</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">DefaultPosition</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">DefaultSize</span><span class="p">,</span> <span class="n">m_checkList_distChoices</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_checkList_dist</span><span class="o">.</span><span class="n">SetToolTip</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">ToolTip</span><span class="p">(</span><span class="sa">u</span><span class="s2">&quot;Select the web distributor (or local) that will be used to scrape the prices.</span><span class="se">\n</span><span class="s2">&quot;</span>
                                                    <span class="s2">&quot;Click right to hot option.&quot;</span><span class="p">))</span>
        <span class="n">sbSizer3</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m_checkList_dist</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">ALL</span> <span class="o">|</span> <span class="n">wx</span><span class="o">.</span><span class="n">EXPAND</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_checkList_dist</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_RIGHT_DOWN</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_textCtrl_distributors_rClick</span><span class="p">)</span>
        <span class="n">bSizer4</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="n">sbSizer3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">EXPAND</span> <span class="o">|</span> <span class="n">wx</span><span class="o">.</span><span class="n">TOP</span> <span class="o">|</span> <span class="n">wx</span><span class="o">.</span><span class="n">LEFT</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>

        <span class="n">wSizer1</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">WrapSizer</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">VERTICAL</span><span class="p">)</span>

        <span class="n">bSizer6</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">BoxSizer</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">VERTICAL</span><span class="p">)</span>

        <span class="n">sbSizer31</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">StaticBoxSizer</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">StaticBox</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m_panel1</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">ID_ANY</span><span class="p">,</span> <span class="sa">u</span><span class="s2">&quot;Recognized EDAs:&quot;</span><span class="p">),</span> <span class="n">wx</span><span class="o">.</span><span class="n">VERTICAL</span><span class="p">)</span>
        <span class="n">m_listBox_edatoolChoices</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_listBox_edatool</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">ListBox</span><span class="p">(</span><span class="n">sbSizer31</span><span class="o">.</span><span class="n">GetStaticBox</span><span class="p">(),</span> <span class="n">wx</span><span class="o">.</span><span class="n">ID_ANY</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">DefaultPosition</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">DefaultSize</span><span class="p">,</span> <span class="n">m_listBox_edatoolChoices</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_listBox_edatool</span><span class="o">.</span><span class="n">SetToolTip</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">ToolTip</span><span class="p">(</span><span class="sa">u</span><span class="s2">&quot;Choose the correct EDA software corresponding to the BOM file.</span><span class="se">\n</span><span class="s2">&quot;</span>
                                                     <span class="s2">&quot;CSVs files are used by the most of commercial software and to make the hand made BOM.&quot;</span><span class="p">))</span>
        <span class="n">sbSizer31</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m_listBox_edatool</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">ALL</span> <span class="o">|</span> <span class="n">wx</span><span class="o">.</span><span class="n">EXPAND</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
        <span class="n">bSizer6</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="n">sbSizer31</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">TOP</span> <span class="o">|</span> <span class="n">wx</span><span class="o">.</span><span class="n">RIGHT</span> <span class="o">|</span> <span class="n">wx</span><span class="o">.</span><span class="n">EXPAND</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>

        <span class="c1"># Allow convert to XLSX to ODS quietly because this load more smoothly on LibreOffice.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_checkBox_XLSXtoODS</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">CheckBox</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m_panel1</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">ID_ANY</span><span class="p">,</span> <span class="sa">u</span><span class="s2">&quot;Convert to ODS&quot;</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">DefaultPosition</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">DefaultSize</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_checkBox_XLSXtoODS</span><span class="o">.</span><span class="n">SetValue</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_checkBox_XLSXtoODS</span><span class="o">.</span><span class="n">SetToolTip</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">ToolTip</span><span class="p">(</span><span class="sa">u</span><span class="s2">&quot;Convert the file output to ODS format quietly.&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_checkBox_XLSXtoODS</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_CHECKBOX</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">updateOutputFilename</span><span class="p">)</span>
        <span class="n">bSizer6</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m_checkBox_XLSXtoODS</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">ALL</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
        <span class="c1"># LibreOffice identification</span>
        <span class="k">global</span> <span class="n">libreoffice_executable</span>
        <span class="k">if</span> <span class="n">sys</span><span class="o">.</span><span class="n">platform</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;win32&quot;</span><span class="p">):</span>
            <span class="n">libreoffice_reg</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;SOFTWARE\LibreOffice\LibreOffice&#39;</span>
            <span class="n">libreoffice_installations</span> <span class="o">=</span> <span class="n">reg_enum_keys</span><span class="p">(</span><span class="n">libreoffice_reg</span><span class="p">,</span> <span class="n">HKEY_LOCAL_MACHINE</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">libreoffice_installations</span><span class="p">:</span>
                <span class="n">debug_overview</span><span class="p">(</span><span class="s1">&#39;Found LibreOffice </span><span class="si">{}</span><span class="s1"> installation(s) version(s).&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">libreoffice_installations</span><span class="p">))</span>
                <span class="n">libreoffice_installations</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="n">StrictVersion</span><span class="p">)</span>
                <span class="c1"># TODO: os.path.join(os.path.join?</span>
                <span class="n">libreoffice_executable</span> <span class="o">=</span> <span class="n">reg_get</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">libreoffice_reg</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">libreoffice_reg</span><span class="p">,</span> <span class="n">libreoffice_installations</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]),</span> <span class="s1">&#39;Path&#39;</span><span class="p">),</span>
                                                 <span class="n">HKEY_LOCAL_MACHINE</span><span class="p">)</span>
                <span class="n">debug_overview</span><span class="p">(</span><span class="s1">&#39;Last LibreOffice installation at </span><span class="si">{}</span><span class="s1">.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">libreoffice_executable</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">debug_overview</span><span class="p">(</span><span class="s1">&#39;LibreOffice not found.&#39;</span><span class="p">)</span>
                <span class="n">libreoffice_executable</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="kn">from</span> <span class="nn">distutils.spawn</span> <span class="kn">import</span> <span class="n">find_executable</span>
            <span class="n">libreoffice_executable</span> <span class="o">=</span> <span class="n">find_executable</span><span class="p">(</span><span class="s1">&#39;libreoffice&#39;</span><span class="p">)</span>
        <span class="c1"># Create a control to convert the XLSX to ODS quietly.</span>
        <span class="k">if</span> <span class="n">libreoffice_executable</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">m_checkBox_XLSXtoODS</span><span class="o">.</span><span class="n">Enable</span><span class="p">()</span>  <span class="c1"># Recognized LibreOffice.</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">debug_obsessive</span><span class="p">(</span><span class="s1">&#39;LibreOffice not found.&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">m_checkBox_XLSXtoODS</span><span class="o">.</span><span class="n">SetValue</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">m_checkBox_openSpreadsheet</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">CheckBox</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m_panel1</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">ID_ANY</span><span class="p">,</span> <span class="sa">u</span><span class="s2">&quot;Open spreadsheet&quot;</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">DefaultPosition</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">DefaultSize</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_checkBox_openSpreadsheet</span><span class="o">.</span><span class="n">SetValue</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_checkBox_openSpreadsheet</span><span class="o">.</span><span class="n">SetToolTip</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">ToolTip</span><span class="p">(</span><span class="sa">u</span><span class="s2">&quot;Open the spreadsheet after finish the KiCost scrape.&quot;</span><span class="p">))</span>
        <span class="n">bSizer6</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m_checkBox_openSpreadsheet</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">ALL</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">m_button_run</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m_panel1</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">ID_ANY</span><span class="p">,</span> <span class="sa">u</span><span class="s2">&quot;KiCost it!&quot;</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">DefaultPosition</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">DefaultSize</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_button_run</span><span class="o">.</span><span class="n">SetToolTip</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">ToolTip</span><span class="p">(</span><span class="sa">u</span><span class="s2">&quot;Click to run KiCost.&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_button_run</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_BUTTON</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">button_run</span><span class="p">)</span>
        <span class="n">bSizer6</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m_button_run</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">ALL</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>

        <span class="n">wSizer1</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="n">bSizer6</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">RIGHT</span> <span class="o">|</span> <span class="n">wx</span><span class="o">.</span><span class="n">EXPAND</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>

        <span class="n">bSizer4</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="n">wSizer1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">EXPAND</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>

        <span class="n">bSizer3</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="n">bSizer4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">EXPAND</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>

        <span class="n">fgSizer1</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">FlexGridSizer</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">fgSizer1</span><span class="o">.</span><span class="n">SetFlexibleDirection</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">BOTH</span><span class="p">)</span>
        <span class="n">fgSizer1</span><span class="o">.</span><span class="n">SetNonFlexibleGrowMode</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">FLEX_GROWMODE_SPECIFIED</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">m_gauge_process</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">Gauge</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m_panel1</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">ID_ANY</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">DefaultPosition</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">DefaultSize</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">GA_HORIZONTAL</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_gauge_process</span><span class="o">.</span><span class="n">SetValue</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_gauge_process</span><span class="o">.</span><span class="n">SetToolTip</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">ToolTip</span><span class="p">(</span><span class="sa">u</span><span class="s2">&quot;Percentage of the scrape process elapsed.&quot;</span><span class="p">))</span>
        <span class="n">fgSizer1</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m_gauge_process</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">ALL</span> <span class="o">|</span> <span class="n">wx</span><span class="o">.</span><span class="n">EXPAND</span> <span class="o">|</span> <span class="n">wx</span><span class="o">.</span><span class="n">ALIGN_CENTER_VERTICAL</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">m_staticText_progressInfo</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">StaticText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m_panel1</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">ID_ANY</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">EmptyString</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">DefaultPosition</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">DefaultSize</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">ALIGN_RIGHT</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_staticText_progressInfo</span><span class="o">.</span><span class="n">Wrap</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_staticText_progressInfo</span><span class="o">.</span><span class="n">SetToolTip</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">ToolTip</span><span class="p">(</span><span class="sa">u</span><span class="s2">&quot;Progress information.&quot;</span><span class="p">))</span>

        <span class="n">fgSizer1</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m_staticText_progressInfo</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">ALL</span> <span class="o">|</span> <span class="n">wx</span><span class="o">.</span><span class="n">EXPAND</span> <span class="o">|</span> <span class="n">wx</span><span class="o">.</span><span class="n">ALIGN_CENTER_VERTICAL</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>

        <span class="n">bSizer3</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="n">fgSizer1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">EXPAND</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>

        <span class="n">m_staticText</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">StaticText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m_panel1</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">ID_ANY</span><span class="p">,</span> <span class="sa">u</span><span class="s2">&quot;Warnings, debug and error messages:&quot;</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">DefaultPosition</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">DefaultSize</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">m_staticText</span><span class="o">.</span><span class="n">Wrap</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">bSizer3</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="n">m_staticText</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">ALL</span> <span class="o">|</span> <span class="n">wx</span><span class="o">.</span><span class="n">EXPAND</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_textCtrl_messages</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">TextCtrl</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m_panel1</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">ID_ANY</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">EmptyString</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">DefaultPosition</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">Size</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span>
                                               <span class="n">wx</span><span class="o">.</span><span class="n">HSCROLL</span> <span class="o">|</span> <span class="n">wx</span><span class="o">.</span><span class="n">TE_MULTILINE</span> <span class="o">|</span> <span class="n">wx</span><span class="o">.</span><span class="n">TE_READONLY</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_textCtrl_messages</span><span class="o">.</span><span class="n">SetToolTip</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">ToolTip</span><span class="p">(</span><span class="sa">u</span><span class="s2">&quot;Process messages and warnings.</span><span class="se">\n</span><span class="s2">Click right to copy or save the log.&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_textCtrl_messages</span><span class="o">.</span><span class="n">SetMinSize</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">Size</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_textCtrl_messages</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_RIGHT_DOWN</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_textCtrl_messages_rClick</span><span class="p">)</span>
        <span class="n">bSizer3</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m_textCtrl_messages</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">ALL</span> <span class="o">|</span> <span class="n">wx</span><span class="o">.</span><span class="n">EXPAND</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>

        <span class="c1"># * Configuration tab.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_panel1</span><span class="o">.</span><span class="n">SetSizer</span><span class="p">(</span><span class="n">bSizer3</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_panel1</span><span class="o">.</span><span class="n">Layout</span><span class="p">()</span>
        <span class="n">bSizer3</span><span class="o">.</span><span class="n">Fit</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m_panel1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_notebook1</span><span class="o">.</span><span class="n">AddPage</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m_panel1</span><span class="p">,</span> <span class="sa">u</span><span class="s2">&quot;Cost BOM creation&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_panel2</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">Panel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m_notebook1</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">ID_ANY</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">DefaultPosition</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">DefaultSize</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">TAB_TRAVERSAL</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_panel2</span><span class="o">.</span><span class="n">SetToolTip</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">ToolTip</span><span class="p">(</span><span class="sa">u</span><span class="s2">&quot;KiCost general configurations tab.&quot;</span><span class="p">))</span>

        <span class="n">bSizer8</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">BoxSizer</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">VERTICAL</span><span class="p">)</span>

        <span class="n">wSizer2</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">WrapSizer</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">HORIZONTAL</span><span class="p">)</span>

        <span class="n">bSizer9</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">BoxSizer</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">VERTICAL</span><span class="p">)</span>

        <span class="n">m_staticText</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">StaticText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m_panel2</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">ID_ANY</span><span class="p">,</span> <span class="sa">u</span><span class="s2">&quot;Spreadsheet currency:&quot;</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">DefaultPosition</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">DefaultSize</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">m_staticText</span><span class="o">.</span><span class="n">Wrap</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">bSizer9</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="n">m_staticText</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">ALL</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_comboBox_currency</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">ComboBox</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m_panel2</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">ID_ANY</span><span class="p">,</span> <span class="sa">u</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">DefaultPosition</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">DefaultSize</span><span class="p">,</span> <span class="p">[],</span> <span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_comboBox_currency</span><span class="o">.</span><span class="n">SetToolTip</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">ToolTip</span><span class="p">(</span><span class="sa">u</span><span class="s2">&quot;Currency to be used to generate the Cost Bill of Materials.</span><span class="se">\n</span><span class="s2">&quot;</span>
                                                       <span class="s2">&quot;In case of not available the current distributor (API/Scrape/...)&quot;</span>
                                                       <span class="s2">&quot; is converted to and distributor column receive a comment.&quot;</span><span class="p">))</span>
        <span class="n">bSizer9</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m_comboBox_currency</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">ALL</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>

        <span class="n">wSizer2</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="n">bSizer9</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">TOP</span> <span class="o">|</span> <span class="n">wx</span><span class="o">.</span><span class="n">LEFT</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>

        <span class="n">bSizer11</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">BoxSizer</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">VERTICAL</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">m_checkBox_collapseRefs</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">CheckBox</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m_panel2</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">ID_ANY</span><span class="p">,</span> <span class="sa">u</span><span class="s2">&quot;Collapse refs&quot;</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">DefaultPosition</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">DefaultSize</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_checkBox_collapseRefs</span><span class="o">.</span><span class="n">SetValue</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_checkBox_collapseRefs</span><span class="o">.</span><span class="n">SetToolTip</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">ToolTip</span><span class="p">(</span><span class="sa">u</span><span class="s2">&quot;Collapse the references in the spreadsheet.</span><span class="se">\n</span><span class="s2">&#39;R1,R2,R3,R4,R9&#39; become &#39;R1-R4,R9&#39; with checked.&quot;</span><span class="p">))</span>
        <span class="n">bSizer11</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m_checkBox_collapseRefs</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">ALL</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>

        <span class="n">m_staticText</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">StaticText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m_panel2</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">ID_ANY</span><span class="p">,</span> <span class="sa">u</span><span class="s2">&quot;Debug level:&quot;</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">DefaultPosition</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">DefaultSize</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">m_staticText</span><span class="o">.</span><span class="n">Wrap</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">bSizer11</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="n">m_staticText</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">ALL</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_spinCtrl_debugLvl</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">SpinCtrl</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m_panel2</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">ID_ANY</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">EmptyString</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">DefaultPosition</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">DefaultSize</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">SP_ARROW_KEYS</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">bSizer11</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m_spinCtrl_debugLvl</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">ALL</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">m_checkBox_quite</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">CheckBox</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m_panel2</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">ID_ANY</span><span class="p">,</span> <span class="sa">u</span><span class="s2">&quot;Quiet mode&quot;</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">DefaultPosition</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">DefaultSize</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_checkBox_quite</span><span class="o">.</span><span class="n">SetToolTip</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">ToolTip</span><span class="p">(</span><span class="sa">u</span><span class="s2">&quot;Enable quiet mode with no warnings or messages at all.&quot;</span><span class="p">))</span>
        <span class="n">bSizer11</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m_checkBox_quite</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">ALL</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">m_checkBox_overwrite</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">CheckBox</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m_panel2</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">ID_ANY</span><span class="p">,</span> <span class="sa">u</span><span class="s2">&quot;Overwrite file&quot;</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">DefaultPosition</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">DefaultSize</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_checkBox_overwrite</span><span class="o">.</span><span class="n">SetValue</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_checkBox_overwrite</span><span class="o">.</span><span class="n">SetToolTip</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">ToolTip</span><span class="p">(</span><span class="sa">u</span><span class="s2">&quot;Allow overwriting of an existing spreadsheet.&quot;</span><span class="p">))</span>
        <span class="n">bSizer11</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m_checkBox_overwrite</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">ALL</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>

        <span class="n">m_staticText</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">StaticText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m_panel2</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">ID_ANY</span><span class="p">,</span> <span class="sa">u</span><span class="s2">&quot;History keep:&quot;</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">DefaultPosition</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">DefaultSize</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">m_staticText</span><span class="o">.</span><span class="n">Wrap</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">bSizer11</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="n">m_staticText</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">ALL</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_spinCtrl_histotyLen</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">SpinCtrl</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m_panel2</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">ID_ANY</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">EmptyString</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">DefaultPosition</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">DefaultSize</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">SP_ARROW_KEYS</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_spinCtrl_histotyLen</span><span class="o">.</span><span class="n">SetToolTip</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">ToolTip</span><span class="p">(</span><span class="sa">u</span><span class="s2">&quot;Quantity of files kept on history.&quot;</span><span class="p">))</span>
        <span class="n">bSizer11</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m_spinCtrl_histotyLen</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">ALL</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_spinCtrl_histotyLen</span><span class="o">.</span><span class="n">SetValue</span><span class="p">(</span><span class="n">FILE_HIST_QTY_DEFAULT</span><span class="p">)</span>

        <span class="n">m_staticText</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">StaticText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m_panel2</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">ID_ANY</span><span class="p">,</span> <span class="sa">u</span><span class="s2">&quot;GUI language:&quot;</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">DefaultPosition</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">DefaultSize</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">m_staticText</span><span class="o">.</span><span class="n">Wrap</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">bSizer11</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="n">m_staticText</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">ALL</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_comboBox_language</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">ComboBox</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m_panel2</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">ID_ANY</span><span class="p">,</span> <span class="sa">u</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">DefaultPosition</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">DefaultSize</span><span class="p">,</span> <span class="p">[],</span> <span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_comboBox_language</span><span class="o">.</span><span class="n">SetToolTip</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">ToolTip</span><span class="p">(</span><span class="sa">u</span><span class="s2">&quot;Setup the guide language (needs restart).&quot;</span><span class="p">))</span>
        <span class="n">bSizer11</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m_comboBox_language</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">ALL</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>

        <span class="n">wSizer2</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="n">bSizer11</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">TOP</span> <span class="o">|</span> <span class="n">wx</span><span class="o">.</span><span class="n">RIGHT</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>

        <span class="n">bSizer8</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="n">wSizer2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">ALL</span> <span class="o">|</span> <span class="n">wx</span><span class="o">.</span><span class="n">EXPAND</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>

        <span class="n">m_staticText</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">StaticText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m_panel2</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">ID_ANY</span><span class="p">,</span> <span class="sa">u</span><span class="s2">&quot;Extra commands:&quot;</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">DefaultPosition</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">DefaultSize</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">m_staticText</span><span class="o">.</span><span class="n">Wrap</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">bSizer8</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="n">m_staticText</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">ALL</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_textCtrl_extraCmd</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">TextCtrl</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m_panel2</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">ID_ANY</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">EmptyString</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">DefaultPosition</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">DefaultSize</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_textCtrl_extraCmd</span><span class="o">.</span><span class="n">SetToolTip</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">ToolTip</span><span class="p">(</span><span class="sa">u</span><span class="s2">&quot;Here use the KiCost extra commands. In the terminal/command type`kicost --help` to check the list.</span><span class="se">\n</span><span class="s2">&quot;</span>
                                                       <span class="s2">&quot;The command here take priority over the other guide control.&quot;</span><span class="p">))</span>

        <span class="n">bSizer8</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m_textCtrl_extraCmd</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">ALL</span> <span class="o">|</span> <span class="n">wx</span><span class="o">.</span><span class="n">EXPAND</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">m_panel2</span><span class="o">.</span><span class="n">SetSizer</span><span class="p">(</span><span class="n">bSizer8</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_panel2</span><span class="o">.</span><span class="n">Layout</span><span class="p">()</span>
        <span class="n">bSizer8</span><span class="o">.</span><span class="n">Fit</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m_panel2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_notebook1</span><span class="o">.</span><span class="n">AddPage</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m_panel2</span><span class="p">,</span> <span class="sa">u</span><span class="s2">&quot;Configurations&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_panel3</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">Panel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m_notebook1</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">ID_ANY</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">DefaultPosition</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">DefaultSize</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">TAB_TRAVERSAL</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_panel3</span><span class="o">.</span><span class="n">SetToolTip</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">ToolTip</span><span class="p">(</span><span class="sa">u</span><span class="s2">&quot;About the software, version installation and update found.&quot;</span><span class="p">))</span>

        <span class="n">bSizer2</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">BoxSizer</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">VERTICAL</span><span class="p">)</span>

        <span class="n">bSizer10</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">BoxSizer</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">HORIZONTAL</span><span class="p">)</span>

        <span class="n">bSizer101</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">BoxSizer</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">VERTICAL</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">m_bitmap_icon</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">StaticBitmap</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m_panel3</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">ID_ANY</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">NullBitmap</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">DefaultPosition</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">Size</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>  <span class="c1"># wx.DefaultSize, 0)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_bitmap_icon</span><span class="o">.</span><span class="n">SetIcon</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">Icon</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">kicostPath</span><span class="p">,</span> <span class="s1">&#39;kicost.ico&#39;</span><span class="p">),</span> <span class="n">wx</span><span class="o">.</span><span class="n">BITMAP_TYPE_ICO</span><span class="p">))</span>
        <span class="n">bSizer101</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m_bitmap_icon</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">CENTER</span> <span class="o">|</span> <span class="n">wx</span><span class="o">.</span><span class="n">ALL</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">m_staticText_version</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">StaticText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m_panel3</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">ID_ANY</span><span class="p">,</span> <span class="sa">u</span><span class="s2">&quot;version&quot;</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">DefaultPosition</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">DefaultSize</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_staticText_version</span><span class="o">.</span><span class="n">Wrap</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_staticText_version</span><span class="o">.</span><span class="n">SetLabel</span><span class="p">(</span><span class="s1">&#39;Version &#39;</span> <span class="o">+</span> <span class="n">__version__</span><span class="p">)</span>
        <span class="n">bSizer101</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m_staticText_version</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">ALL</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">m_button_open_webpage</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m_panel3</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">ID_ANY</span><span class="p">,</span> <span class="sa">u</span><span class="s2">&quot;Online manual&quot;</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">DefaultPosition</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">DefaultSize</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_button_open_webpage</span><span class="o">.</span><span class="n">SetToolTip</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">ToolTip</span><span class="p">(</span><span class="sa">u</span><span class="s2">&quot;Click for official web page user manual.&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_button_open_webpage</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_LEFT_DOWN</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">open_webpage_click</span><span class="p">)</span>
        <span class="n">bSizer101</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m_button_open_webpage</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">CENTER</span> <span class="o">|</span> <span class="n">wx</span><span class="o">.</span><span class="n">ALL</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">m_button_open_issuepage</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m_panel3</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">ID_ANY</span><span class="p">,</span> <span class="sa">u</span><span class="s2">&quot;Report issue page&quot;</span><span class="p">,</span>
                                                 <span class="n">wx</span><span class="o">.</span><span class="n">DefaultPosition</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">DefaultSize</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_button_open_issuepage</span><span class="o">.</span><span class="n">SetToolTip</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">ToolTip</span><span class="p">(</span><span class="sa">u</span><span class="s2">&quot;Open KiCost project ISSUE report page on GitHub.&quot;</span><span class="p">))</span>
        <span class="n">bSizer101</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m_button_open_issuepage</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">CENTER</span> <span class="o">|</span> <span class="n">wx</span><span class="o">.</span><span class="n">ALL</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_button_open_issuepage</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_LEFT_DOWN</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">open_issuepage_click</span><span class="p">)</span>

        <span class="n">bSizer111</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">BoxSizer</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">VERTICAL</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">m_bitmap_icon</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">StaticBitmap</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m_panel3</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">ID_ANY</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">NullBitmap</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">DefaultPosition</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">Size</span><span class="p">(</span><span class="mi">400</span><span class="p">,</span> <span class="mi">132</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>  <span class="c1"># wx.DefaultSize, 0)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_bitmap_icon</span><span class="o">.</span><span class="n">SetIcon</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">Icon</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">kicostPath</span><span class="p">,</span> <span class="s1">&#39;kitspace.png&#39;</span><span class="p">),</span> <span class="n">wx</span><span class="o">.</span><span class="n">BITMAP_TYPE_PNG</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_bitmap_icon</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_LEFT_DOWN</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">open_powered_by</span><span class="p">)</span>
        <span class="n">bSizer111</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m_bitmap_icon</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">CENTER</span> <span class="o">|</span> <span class="n">wx</span><span class="o">.</span><span class="n">ALL</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">m_button_check_updates</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m_panel3</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">ID_ANY</span><span class="p">,</span> <span class="sa">u</span><span class="s2">&quot;Check for updates&quot;</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">DefaultPosition</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">DefaultSize</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_button_check_updates</span><span class="o">.</span><span class="n">SetToolTip</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">ToolTip</span><span class="p">(</span><span class="sa">u</span><span class="s2">&quot;Click for compare you version with the most recent released.&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_button_check_updates</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_BUTTON</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_updates_click</span><span class="p">)</span>
        <span class="n">bSizer111</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m_button_check_updates</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">CENTER</span> <span class="o">|</span> <span class="n">wx</span><span class="o">.</span><span class="n">ALL</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">m_button_open_updatepage</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m_panel3</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">ID_ANY</span><span class="p">,</span> <span class="sa">u</span><span class="s2">&quot;Open PyPI page&quot;</span><span class="p">,</span>
                                                  <span class="n">wx</span><span class="o">.</span><span class="n">DefaultPosition</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">DefaultSize</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_button_open_updatepage</span><span class="o">.</span><span class="n">SetToolTip</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">ToolTip</span><span class="p">(</span><span class="sa">u</span><span class="s2">&quot;Open PyPI page with the most recent KiCost version.&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_button_open_updatepage</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_LEFT_DOWN</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">open_updatepage_click</span><span class="p">)</span>
        <span class="n">bSizer111</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m_button_open_updatepage</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>  <span class="n">wx</span><span class="o">.</span><span class="n">CENTER</span> <span class="o">|</span> <span class="n">wx</span><span class="o">.</span><span class="n">ALL</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>

        <span class="n">bSizer10</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="n">bSizer101</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">EXPAND</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
        <span class="n">bSizer10</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="n">bSizer111</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">EXPAND</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>

        <span class="n">bSizer2</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="n">bSizer10</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">ALL</span> <span class="o">|</span> <span class="n">wx</span><span class="o">.</span><span class="n">EXPAND</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">m_text_credits</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">TextCtrl</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m_panel3</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">ID_ANY</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">EmptyString</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">DefaultPosition</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">Size</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span>
                                          <span class="n">wx</span><span class="o">.</span><span class="n">TE_READONLY</span> <span class="o">|</span> <span class="n">wx</span><span class="o">.</span><span class="n">TE_MULTILINE</span> <span class="o">|</span> <span class="n">wx</span><span class="o">.</span><span class="n">TE_AUTO_URL</span> <span class="o">|</span> <span class="n">wx</span><span class="o">.</span><span class="n">TE_BESTWRAP</span><span class="p">)</span>
        <span class="n">bSizer2</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m_text_credits</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">ALL</span> <span class="o">|</span> <span class="n">wx</span><span class="o">.</span><span class="n">EXPAND</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_text_credits</span><span class="o">.</span><span class="n">SetValue</span><span class="p">(</span><span class="s1">&#39;jkjtke&#39;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">m_panel3</span><span class="o">.</span><span class="n">SetSizer</span><span class="p">(</span><span class="n">bSizer2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_panel3</span><span class="o">.</span><span class="n">Layout</span><span class="p">()</span>
        <span class="n">bSizer2</span><span class="o">.</span><span class="n">Fit</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m_panel3</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_notebook1</span><span class="o">.</span><span class="n">AddPage</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m_panel3</span><span class="p">,</span> <span class="sa">u</span><span class="s2">&quot;About&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>

        <span class="n">bSizer1</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m_notebook1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">EXPAND</span> <span class="o">|</span> <span class="n">wx</span><span class="o">.</span><span class="n">ALL</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">SetSizer</span><span class="p">(</span><span class="n">bSizer1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Layout</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Centre</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">BOTH</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_CLOSE</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">app_close</span><span class="p">)</span>
        <span class="c1"># Set the window size to fit all controls, useful in first execution without the last size and position saved.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Fit</span><span class="p">()</span>
        <span class="c1"># self.SetSizeHints(wx.Size(40, 40), wx.DefaultSize) # Only available on wxPython4.</span>

        <span class="c1"># Set the application windows title and configurations.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">SetTitle</span><span class="p">(</span><span class="s1">&#39;KiCost v&#39;</span> <span class="o">+</span> <span class="n">__version__</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">SetIcon</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">Icon</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">kicostPath</span><span class="p">,</span> <span class="s1">&#39;kicost.ico&#39;</span><span class="p">),</span> <span class="n">wx</span><span class="o">.</span><span class="n">BITMAP_TYPE_ICO</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">set_properties</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">SetDropTarget</span><span class="p">(</span><span class="n">FileDropTarget</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span>  <span class="c1"># Start the drop file in all the window.</span>
        <span class="n">debug_overview</span><span class="p">(</span><span class="s1">&#39;Loaded KiCost v&#39;</span> <span class="o">+</span> <span class="n">__version__</span><span class="p">)</span>

        <span class="c1"># Set up event handler for any worker thread results</span>
        <span class="c1"># It will receive notifications from the KiCost thread</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">event_id</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">NewId</span><span class="p">()</span> <span class="k">if</span> <span class="n">wx_old</span> <span class="k">else</span> <span class="n">wx</span><span class="o">.</span><span class="n">NewIdRef</span><span class="p">()</span><span class="o">.</span><span class="n">GetId</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Connect</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">event_id</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">update_kicost_run</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__del__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">pass</span>

    <span class="c1"># Virtual event handlers, overwrite them in your derived class</span>

    <span class="c1"># ----------------------------------------------------------------------</span>
    <span class="k">def</span> <span class="nf">app_close</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39; @brief Close event, used to call the save settings.&#39;&#39;&#39;</span>
        <span class="n">event</span><span class="o">.</span><span class="n">Skip</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">save_properties</span><span class="p">()</span>

    <span class="c1"># ----------------------------------------------------------------------</span>
    <span class="sd">&#39;&#39;&#39;About page, report and official informations.&#39;&#39;&#39;</span>
    <span class="k">def</span> <span class="nf">open_webpage_click</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39; @brief Open the official software web page in the default browser.&#39;&#39;&#39;</span>
        <span class="n">event</span><span class="o">.</span><span class="n">Skip</span><span class="p">()</span>
        <span class="n">webbrowser</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">PAGE_OFFICIAL</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">open_issuepage_click</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39; @brief Open the official software web page in the default browser.&#39;&#39;&#39;</span>
        <span class="n">event</span><span class="o">.</span><span class="n">Skip</span><span class="p">()</span>
        <span class="n">webbrowser</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">PAGE_DEV</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">open_updatepage_click</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39; @brief Open the page to download the last version.&#39;&#39;&#39;</span>
        <span class="n">event</span><span class="o">.</span><span class="n">Skip</span><span class="p">()</span>
        <span class="n">webbrowser</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">PAGE_UPDATE</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">open_powered_by</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39; @brief Open partner that power the KiCost.&#39;&#39;&#39;</span>
        <span class="n">event</span><span class="o">.</span><span class="n">Skip</span><span class="p">()</span>
        <span class="n">webbrowser</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">PAGE_POWERED_BY</span><span class="p">)</span>

    <span class="c1"># ----------------------------------------------------------------------</span>
    <span class="k">def</span> <span class="nf">check_updates_click</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39; @brief Check version to update if the &quot;About&quot; tab.&#39;&#39;&#39;</span>
        <span class="n">event</span><span class="o">.</span><span class="n">Skip</span><span class="p">()</span>

        <span class="k">def</span> <span class="nf">checkUpdate</span><span class="p">():</span>
            <span class="sd">&#39;&#39;&#39;Check for updates.&#39;&#39;&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">m_button_check_updates</span><span class="o">.</span><span class="n">SetLabel</span><span class="p">(</span><span class="sa">u</span><span class="s2">&quot;Checking for updates...&quot;</span><span class="p">)</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">PAGE_UPDATE</span><span class="p">)</span>
                <span class="n">html</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">text</span>
                <span class="n">offical_last_version</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;kicost (\d+\.\d+\.\d+)&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">html</span><span class="p">),</span> <span class="n">flags</span><span class="o">=</span><span class="n">re</span><span class="o">.</span><span class="n">IGNORECASE</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">StrictVersion</span><span class="p">(</span><span class="n">offical_last_version</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">StrictVersion</span><span class="p">(</span><span class="n">__version__</span><span class="p">):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">m_button_check_updates</span><span class="o">.</span><span class="n">SetLabel</span><span class="p">(</span><span class="sa">u</span><span class="s2">&quot;Found v</span><span class="si">{}</span><span class="s2">.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">offical_last_version</span><span class="p">))</span>
                    <span class="c1"># self.m_staticText_update.Bind(wx.EVT_LEFT_UP, self.m_staticText_update_click)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">m_button_check_updates</span><span class="o">.</span><span class="n">SetLabel</span><span class="p">(</span><span class="sa">u</span><span class="s2">&quot;KiCost is up to date&quot;</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">m_button_check_updates</span><span class="o">.</span><span class="n">SetLabel</span><span class="p">(</span><span class="sa">u</span><span class="s2">&quot;No information&quot;</span><span class="p">)</span>
        <span class="n">wx</span><span class="o">.</span><span class="n">CallLater</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="n">checkUpdate</span><span class="p">)</span>  <span class="c1"># Thread optimized for graphical elements change.</span>

    <span class="c1"># ----------------------------------------------------------------------</span>
    <span class="sd">&#39;&#39;&#39;Pop-up menus on main tab.&#39;&#39;&#39;</span>
    <span class="k">def</span> <span class="nf">m_textCtrl_messages_rClick</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39; @brief Open the context menu with save log options.&#39;&#39;&#39;</span>
        <span class="n">event</span><span class="o">.</span><span class="n">Skip</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">PopupMenu</span><span class="p">(</span><span class="n">menuMessages</span><span class="p">(</span><span class="bp">self</span><span class="p">),</span> <span class="n">event</span><span class="o">.</span><span class="n">GetPosition</span><span class="p">())</span>

    <span class="k">def</span> <span class="nf">m_textCtrl_distributors_rClick</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39; @brief Open the context menu with distributors options.&#39;&#39;&#39;</span>
        <span class="n">event</span><span class="o">.</span><span class="n">Skip</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">PopupMenu</span><span class="p">(</span><span class="n">menuSelection</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m_checkList_dist</span><span class="p">),</span> <span class="n">event</span><span class="o">.</span><span class="n">GetPosition</span><span class="p">())</span>

    <span class="c1"># ----------------------------------------------------------------------</span>
    <span class="k">def</span> <span class="nf">m_comboBox_files_selecthist</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39; @brief Update the select EDA module tool when changed the file selected in the history, update the order and delete if file not existent.&#39;&#39;&#39;</span>
        <span class="n">event</span><span class="o">.</span><span class="n">Skip</span><span class="p">()</span>
        <span class="c1"># Check if the file in the file name exist and</span>
        <span class="c1"># update the history sequence, if don&#39;t, remove it.</span>
        <span class="n">histSelected</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">GetSelection</span><span class="p">()</span>
        <span class="n">fileNames</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">GetString</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_comboBox_files</span><span class="o">.</span><span class="n">Delete</span><span class="p">(</span><span class="n">histSelected</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">all</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">f</span><span class="p">)</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">re</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">SEP_FILES</span><span class="p">,</span> <span class="n">fileNames</span><span class="p">)):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">m_comboBox_files</span><span class="o">.</span><span class="n">Insert</span><span class="p">(</span><span class="n">fileNames</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">updateEDAselection</span><span class="p">()</span>  <span class="c1"># Auto-select the EDA module.</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">updateOutputFilename</span><span class="p">()</span>  <span class="c1"># Update the output file name on GUI text.</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">m_comboBox_files</span><span class="o">.</span><span class="n">SetValue</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>

    <span class="c1"># ----------------------------------------------------------------------</span>
    <span class="k">def</span> <span class="nf">updateOutputFilename</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39; @brief Update the output file name on the GUI.&#39;&#39;&#39;</span>
        <span class="n">spreadsheet_file</span> <span class="o">=</span> <span class="n">output_filename</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">SEP_FILES</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_comboBox_files</span><span class="o">.</span><span class="n">GetValue</span><span class="p">()))</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_checkBox_XLSXtoODS</span><span class="o">.</span><span class="n">GetValue</span><span class="p">():</span>
            <span class="n">spreadsheet_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">spreadsheet_file</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;.ods&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_text_saveas</span><span class="o">.</span><span class="n">SetValue</span><span class="p">(</span><span class="n">spreadsheet_file</span><span class="p">)</span>

    <span class="c1"># ----------------------------------------------------------------------</span>
    <span class="k">def</span> <span class="nf">updateEDAselection</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39; @brief Update the EDA selection in the listBox based on the comboBox actual text.&#39;&#39;&#39;</span>
        <span class="n">fileNames</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">SEP_FILES</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_comboBox_files</span><span class="o">.</span><span class="n">GetValue</span><span class="p">())</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">fileNames</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">eda_module</span> <span class="o">=</span> <span class="n">file_eda_match</span><span class="p">(</span><span class="n">fileNames</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="k">if</span> <span class="n">eda_module</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">m_listBox_edatool</span><span class="o">.</span><span class="n">SetSelection</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m_listBox_edatool</span><span class="o">.</span><span class="n">FindString</span><span class="p">(</span><span class="n">get_eda_label</span><span class="p">(</span><span class="n">eda_module</span><span class="p">)))</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">fileNames</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="c1"># Check if all the EDA are the same. For different ones,</span>
            <span class="c1"># the guide is not able now to deal, need improvement</span>
            <span class="c1"># on `self.m_listBox_edatool`.</span>
            <span class="n">eda_module</span> <span class="o">=</span> <span class="n">file_eda_match</span><span class="p">(</span><span class="n">fileNames</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="k">for</span> <span class="n">fName</span> <span class="ow">in</span> <span class="n">fileNames</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span>
                <span class="k">if</span> <span class="n">file_eda_match</span><span class="p">(</span><span class="n">fName</span><span class="p">)</span> <span class="o">!=</span> <span class="n">eda_module</span><span class="p">:</span>
                    <span class="k">return</span>
            <span class="k">if</span> <span class="n">eda_module</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">m_listBox_edatool</span><span class="o">.</span><span class="n">SetSelection</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m_listBox_edatool</span><span class="o">.</span><span class="n">FindString</span><span class="p">(</span><span class="n">get_eda_label</span><span class="p">(</span><span class="n">eda_module</span><span class="p">)))</span>

    <span class="c1"># ----------------------------------------------------------------------</span>
    <span class="k">def</span> <span class="nf">button_openfile</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; @brief Create and show the Open FileDialog&quot;&quot;&quot;</span>
        <span class="n">event</span><span class="o">.</span><span class="n">Skip</span><span class="p">()</span>
        <span class="n">actualDir</span> <span class="o">=</span> <span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_comboBox_files</span><span class="o">.</span><span class="n">GetValue</span><span class="p">()</span> <span class="k">else</span>
                     <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m_comboBox_files</span><span class="o">.</span><span class="n">GetValue</span><span class="p">())))</span>
        <span class="n">dlg</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">FileDialog</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="o">=</span><span class="s2">&quot;Select BOM(s)&quot;</span><span class="p">,</span> <span class="n">defaultDir</span><span class="o">=</span><span class="n">actualDir</span><span class="p">,</span>
                            <span class="n">defaultFile</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">wildcard</span><span class="o">=</span><span class="n">WILDCARD_BOM</span><span class="p">,</span>
                            <span class="n">style</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">FD_OPEN</span> <span class="o">|</span> <span class="n">wx</span><span class="o">.</span><span class="n">FD_MULTIPLE</span> <span class="o">|</span> <span class="n">wx</span><span class="o">.</span><span class="n">FD_CHANGE_DIR</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">dlg</span><span class="o">.</span><span class="n">ShowModal</span><span class="p">()</span> <span class="o">==</span> <span class="n">wx</span><span class="o">.</span><span class="n">ID_OK</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">addFile</span><span class="p">(</span><span class="n">dlg</span><span class="o">.</span><span class="n">GetPaths</span><span class="p">())</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">updateOutputFilename</span><span class="p">()</span>  <span class="c1"># Update the output file name on GUI text.</span>
        <span class="n">dlg</span><span class="o">.</span><span class="n">Destroy</span><span class="p">()</span>

    <span class="c1"># ----------------------------------------------------------------------</span>
    <span class="k">def</span> <span class="nf">button_saveas</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; @brief Create and show the Save As... FileDialog.&quot;&quot;&quot;</span>
        <span class="n">event</span><span class="o">.</span><span class="n">Skip</span><span class="p">()</span>
        <span class="n">wildcard</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;Open format (*.ods)|*.ods&quot;</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_checkBox_XLSXtoODS</span><span class="o">.</span><span class="n">GetValue</span><span class="p">()</span>
                    <span class="k">else</span> <span class="s2">&quot;Microsoft Excel (*.xlsx)|*.xlsx&quot;</span><span class="p">)</span>
        <span class="n">actualFile</span> <span class="o">=</span> <span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_text_saveas</span><span class="o">.</span><span class="n">GetValue</span><span class="p">()</span> <span class="k">else</span>
                      <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m_text_saveas</span><span class="o">.</span><span class="n">GetValue</span><span class="p">())))</span>
        <span class="n">dlg</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">FileDialog</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="o">=</span><span class="s2">&quot;Save spreadsheet as...&quot;</span><span class="p">,</span> <span class="n">defaultDir</span><span class="o">=</span><span class="n">actualFile</span><span class="p">,</span>
                            <span class="n">defaultFile</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">wildcard</span><span class="o">=</span><span class="n">wildcard</span><span class="p">,</span>
                            <span class="n">style</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">FD_SAVE</span> <span class="o">|</span> <span class="n">wx</span><span class="o">.</span><span class="n">FD_CHANGE_DIR</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">dlg</span><span class="o">.</span><span class="n">ShowModal</span><span class="p">()</span> <span class="o">==</span> <span class="n">wx</span><span class="o">.</span><span class="n">ID_OK</span><span class="p">:</span>
            <span class="n">spreadsheet_file</span> <span class="o">=</span> <span class="n">dlg</span><span class="o">.</span><span class="n">GetPaths</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="s1">&#39;^.(xlsx|odt)$&#39;</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">spreadsheet_file</span><span class="p">)[</span><span class="mi">1</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">IGNORECASE</span><span class="p">):</span>
                <span class="n">spreadsheet_file</span> <span class="o">+=</span> <span class="p">(</span><span class="s1">&#39;.ods&#39;</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_checkBox_XLSXtoODS</span><span class="o">.</span><span class="n">GetValue</span><span class="p">()</span> <span class="k">else</span> <span class="s1">&#39;.xlsx&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">m_text_saveas</span><span class="o">.</span><span class="n">SetValue</span><span class="p">(</span><span class="n">spreadsheet_file</span><span class="p">)</span>
        <span class="n">dlg</span><span class="o">.</span><span class="n">Destroy</span><span class="p">()</span>

    <span class="c1"># ----------------------------------------------------------------------</span>
    <span class="k">def</span> <span class="nf">addFile</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filesName</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39; @brief Add the file(s) to the history, updating it (and delete the too old).&#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="n">py_2</span><span class="p">:</span>
            <span class="n">sorted_files</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">filesName</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">unicode</span><span class="o">.</span><span class="n">lower</span><span class="p">)</span>  <span class="c1"># noqa: F821</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">sorted_files</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">filesName</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="nb">str</span><span class="o">.</span><span class="n">lower</span><span class="p">)</span>
        <span class="n">fileBOM</span> <span class="o">=</span> <span class="n">SEP_FILES</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">sorted_files</span><span class="p">)</span>  <span class="c1"># Add the files sorted.</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_comboBox_files</span><span class="o">.</span><span class="n">FindString</span><span class="p">(</span><span class="n">fileBOM</span><span class="p">)</span> <span class="o">==</span> <span class="n">wx</span><span class="o">.</span><span class="n">NOT_FOUND</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">m_comboBox_files</span><span class="o">.</span><span class="n">Insert</span><span class="p">(</span><span class="n">fileBOM</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_comboBox_files</span><span class="o">.</span><span class="n">SetValue</span><span class="p">(</span><span class="n">fileBOM</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">m_comboBox_files</span><span class="o">.</span><span class="n">Delete</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m_spinCtrl_histotyLen</span><span class="o">.</span><span class="n">GetValue</span><span class="p">()</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># Keep 10 files on history.</span>
        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">updateEDAselection</span><span class="p">()</span>

    <span class="c1"># ----------------------------------------------------------------------</span>
    <span class="k">def</span> <span class="nf">button_run</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39; @brief Call to run KiCost.&#39;&#39;&#39;</span>
        <span class="n">wx</span><span class="o">.</span><span class="n">CallAfter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">run</span><span class="p">)</span>

    <span class="c1"># ----------------------------------------------------------------------</span>
    <span class="k">def</span> <span class="nf">update_kicost_run</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">status</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39; @brief Receives the message indicating the end of KiCost thread.&#39;&#39;&#39;</span>
        <span class="c1"># The KiCost thread is finished</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_gauge_process</span><span class="o">.</span><span class="n">SetValue</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_button_run</span><span class="o">.</span><span class="n">Enable</span><span class="p">()</span>
        <span class="k">return</span>

    <span class="c1"># ----------------------------------------------------------------------</span>
    <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39; @brief Run KiCost.</span>
<span class="sd">            Run KiCost in the GUI interface updating the process bar and messages.&#39;&#39;&#39;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">m_gauge_process</span><span class="o">.</span><span class="n">SetValue</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_button_run</span><span class="o">.</span><span class="n">Disable</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">save_properties</span><span class="p">()</span>  <span class="c1"># Save the current graphical configuration before call the KiCost.</span>

        <span class="k">class</span> <span class="nc">argments</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="n">args</span> <span class="o">=</span> <span class="n">argments</span><span class="p">()</span>

        <span class="n">args</span><span class="o">.</span><span class="n">input</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">SEP_FILES</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_comboBox_files</span><span class="o">.</span><span class="n">GetValue</span><span class="p">())</span>
        <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">args</span><span class="o">.</span><span class="n">input</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">f</span><span class="p">):</span>
                <span class="n">info</span><span class="p">(</span><span class="s1">&#39;No valid file(s) selected.&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">m_button_run</span><span class="o">.</span><span class="n">Enable</span><span class="p">()</span>
                <span class="k">return</span>  <span class="c1"># Not a valid file(s).</span>

        <span class="n">spreadsheet_file</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_text_saveas</span><span class="o">.</span><span class="n">GetValue</span><span class="p">()</span>
        <span class="c1"># Handle case where output is going into an existing spreadsheet file.</span>
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">spreadsheet_file</span><span class="p">):</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_checkBox_overwrite</span><span class="o">.</span><span class="n">GetValue</span><span class="p">():</span>
                <span class="n">dlg</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">MessageDialog</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;The file output </span><span class="se">\&#39;</span><span class="si">{}</span><span class="se">\&#39;</span><span class="s2"> already exit, do you want overwrite?&quot;</span>
                                       <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">spreadsheet_file</span><span class="p">)),</span>
                                       <span class="s2">&quot;Confirm Overwrite&quot;</span><span class="p">,</span>
                                       <span class="n">wx</span><span class="o">.</span><span class="n">YES_NO</span> <span class="o">|</span> <span class="n">wx</span><span class="o">.</span><span class="n">YES_DEFAULT</span> <span class="o">|</span> <span class="n">wx</span><span class="o">.</span><span class="n">ICON_QUESTION</span> <span class="o">|</span> <span class="n">wx</span><span class="o">.</span><span class="n">STAY_ON_TOP</span> <span class="o">|</span> <span class="n">wx</span><span class="o">.</span><span class="n">CENTER</span><span class="p">)</span>
                <span class="n">result</span> <span class="o">=</span> <span class="n">dlg</span><span class="o">.</span><span class="n">ShowModal</span><span class="p">()</span>
                <span class="n">dlg</span><span class="o">.</span><span class="n">Destroy</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">result</span> <span class="o">==</span> <span class="n">wx</span><span class="o">.</span><span class="n">ID_NO</span><span class="p">:</span>
                    <span class="n">info</span><span class="p">(</span><span class="s1">&#39;Not able to overwrite </span><span class="se">\&#39;</span><span class="si">{}</span><span class="se">\&#39;</span><span class="s1">...&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">spreadsheet_file</span><span class="p">)))</span>
                    <span class="k">return</span>
        <span class="n">spreadsheet_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">spreadsheet_file</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;.xlsx&#39;</span>  <span class="c1"># Force the output (for the CLI interface) to be .XLSX.</span>
        <span class="n">args</span><span class="o">.</span><span class="n">output</span> <span class="o">=</span> <span class="n">spreadsheet_file</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_textCtrl_extraCmd</span><span class="o">.</span><span class="n">GetValue</span><span class="p">():</span>
            <span class="n">extra_commands</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_textCtrl_extraCmd</span><span class="o">.</span><span class="n">GetValue</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">extra_commands</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">def</span> <span class="nf">str_to_arg</span><span class="p">(</span><span class="n">commands</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">commands</span><span class="p">:</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="k">return</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="n">c</span><span class="o">+</span><span class="s1">&#39; (.+)&#39;</span><span class="p">,</span> <span class="n">extra_commands</span><span class="p">))</span>
                    <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
                        <span class="k">continue</span>
            <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
                <span class="k">pass</span>
            <span class="k">finally</span><span class="p">:</span>
                <span class="k">return</span> <span class="s1">&#39;&#39;</span>
        <span class="n">args</span><span class="o">.</span><span class="n">fields</span> <span class="o">=</span> <span class="n">str_to_arg</span><span class="p">([</span><span class="s1">&#39;--fields&#39;</span><span class="p">,</span> <span class="s1">&#39;-f&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
        <span class="n">args</span><span class="o">.</span><span class="n">ignore_fields</span> <span class="o">=</span> <span class="n">str_to_arg</span><span class="p">([</span><span class="s1">&#39;--ignore_fields&#39;</span><span class="p">,</span> <span class="s1">&#39;-ign&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
        <span class="n">args</span><span class="o">.</span><span class="n">group_fields</span> <span class="o">=</span> <span class="n">str_to_arg</span><span class="p">([</span><span class="s1">&#39;--group_fields&#39;</span><span class="p">,</span> <span class="s1">&#39;-grp&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
        <span class="n">args</span><span class="o">.</span><span class="n">translate_fields</span> <span class="o">=</span> <span class="n">str_to_arg</span><span class="p">([</span><span class="s1">&#39;--translate_fields&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
        <span class="n">args</span><span class="o">.</span><span class="n">variant</span> <span class="o">=</span> <span class="n">str_to_arg</span><span class="p">([</span><span class="s1">&#39;--variant&#39;</span><span class="p">,</span> <span class="s1">&#39;-var&#39;</span><span class="p">])</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">args</span><span class="o">.</span><span class="n">currency</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;\((\w</span><span class="si">{3}</span><span class="s1">) .*\).*&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_comboBox_currency</span><span class="o">.</span><span class="n">GetValue</span><span class="p">())[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
            <span class="n">args</span><span class="o">.</span><span class="n">currency</span> <span class="o">=</span> <span class="s1">&#39;USD&#39;</span>  <span class="c1"># Doesn&#39;t work under Python 2 so I&#39;m just ignoring it.</span>

        <span class="n">args</span><span class="o">.</span><span class="n">collapse_refs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_checkBox_collapseRefs</span><span class="o">.</span><span class="n">GetValue</span><span class="p">()</span>  <span class="c1"># Collapse refs in the spreadsheet.</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_listBox_edatool</span><span class="o">.</span><span class="n">GetStringSelection</span><span class="p">():</span>
            <span class="k">for</span> <span class="n">eda</span> <span class="ow">in</span> <span class="n">get_registered_eda_names</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">get_eda_label</span><span class="p">(</span><span class="n">eda</span><span class="p">)</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_listBox_edatool</span><span class="o">.</span><span class="n">GetStringSelection</span><span class="p">():</span>
                    <span class="n">args</span><span class="o">.</span><span class="n">eda_name</span> <span class="o">=</span> <span class="n">eda</span>  <span class="c1"># The selected EDA module on GUI.</span>
                    <span class="k">break</span>

        <span class="n">dist_list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="c1"># Get the current distributors to scrape.</span>
        <span class="c1"># choisen_dist = list(self.m_checkList_dist.GetCheckedItems()) # Only valid on wxPy4.</span>
        <span class="n">choisen_dist</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m_checkList_dist</span><span class="o">.</span><span class="n">GetCount</span><span class="p">())</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_checkList_dist</span><span class="o">.</span><span class="n">IsChecked</span><span class="p">(</span><span class="n">i</span><span class="p">)]</span>
        <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="n">choisen_dist</span><span class="p">:</span>
            <span class="n">dist_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">get_dist_name_from_label</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m_checkList_dist</span><span class="o">.</span><span class="n">GetString</span><span class="p">(</span><span class="n">idx</span><span class="p">)))</span>
        <span class="n">args</span><span class="o">.</span><span class="n">include</span> <span class="o">=</span> <span class="n">dist_list</span>
        <span class="n">args</span><span class="o">.</span><span class="n">convert_to_ods</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_checkBox_XLSXtoODS</span><span class="o">.</span><span class="n">GetValue</span><span class="p">()</span>
        <span class="n">args</span><span class="o">.</span><span class="n">open_spreadsheet</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_checkBox_openSpreadsheet</span><span class="o">.</span><span class="n">GetValue</span><span class="p">()</span>
        <span class="c1"># Now start the KiCost thread</span>
        <span class="n">KiCostThread</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">event_id</span><span class="p">)</span>

    <span class="c1"># ----------------------------------------------------------------------</span>
    <span class="k">def</span> <span class="nf">set_properties</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39; @brief Set the current proprieties of the graphical elements.&#39;&#39;&#39;</span>

        <span class="c1"># Current distributors module recognized.</span>
        <span class="n">distributors_list</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">([</span><span class="n">get_distributor_info</span><span class="p">(</span><span class="n">d</span><span class="p">)</span><span class="o">.</span><span class="n">label</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">get_distributors_iter</span><span class="p">()</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">get_distributor_info</span><span class="p">(</span><span class="n">d</span><span class="p">)</span><span class="o">.</span><span class="n">is_local</span><span class="p">()])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_checkList_dist</span><span class="o">.</span><span class="n">Clear</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">distributors_list</span><span class="p">:</span>  <span class="c1"># Make this for wxPy3 compatibility, not allow include a list.</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">m_checkList_dist</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
        <span class="c1"># self.m_checkList_dist.Append(distributors_list)</span>
        <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">distributors_list</span><span class="p">)):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">m_checkList_dist</span><span class="o">.</span><span class="n">Check</span><span class="p">(</span><span class="n">idx</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>  <span class="c1"># All start checked (after is modified by the configuration file).</span>

        <span class="c1"># Current EDA tools module recognized.</span>
        <span class="n">eda_names</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">get_registered_eda_labels</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_listBox_edatool</span><span class="o">.</span><span class="n">Clear</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">eda_names</span><span class="p">:</span>  <span class="c1"># Make this for wxPy3 compatibility, not allow include a list.</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">m_listBox_edatool</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
        <span class="c1"># self.m_listBox_edatool.Append(eda_names)</span>

        <span class="c1"># Get all the currencies present.</span>
        <span class="n">loc</span> <span class="o">=</span> <span class="n">locale</span><span class="o">.</span><span class="n">getdefaultlocale</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">currencyList</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">list_currencies</span><span class="p">()))</span>
        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">currencyList</span><span class="p">)):</span>
            <span class="n">currency</span> <span class="o">=</span> <span class="n">currencyList</span><span class="p">[</span><span class="n">c</span><span class="p">]</span>
            <span class="n">c_text</span> <span class="o">=</span> <span class="s1">&#39;(</span><span class="si">{a}</span><span class="s1"> </span><span class="si">{s}</span><span class="s1">) </span><span class="si">{n}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="n">currency</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="n">get_currency_symbol</span><span class="p">(</span><span class="n">currency</span><span class="p">,</span> <span class="n">locale</span><span class="o">=</span><span class="n">loc</span><span class="p">),</span> <span class="n">n</span><span class="o">=</span><span class="n">get_currency_name</span><span class="p">(</span><span class="n">currency</span><span class="p">,</span> <span class="n">locale</span><span class="o">=</span><span class="n">loc</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">m_comboBox_currency</span><span class="o">.</span><span class="n">Insert</span><span class="p">(</span><span class="n">c_text</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

        <span class="c1"># Get all languages we support ... well just one ;-)</span>
        <span class="c1"># languages = &#39;{n} ({s})&#39;.format(n=babel.Locale(DEFAULT_LANGUAGE).get_language_name(), s=DEFAULT_LANGUAGE),</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_comboBox_language</span><span class="o">.</span><span class="n">Insert</span><span class="p">(</span><span class="s1">&#39;American English (en_US)&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

        <span class="c1"># Credits and other informations, search by `AUTHOR.rst` file.</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">credits_file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">kicostPath</span><span class="p">,</span> <span class="s1">&#39;AUTHORS.rst&#39;</span><span class="p">))</span>
            <span class="n">credits</span> <span class="o">=</span> <span class="n">credits_file</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
            <span class="n">credits_file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
            <span class="n">credits</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;&#39;&#39;=======</span>
<span class="s1">            Credits</span>
<span class="s1">            =======</span>
<span class="s1">            Development Lead:</span>
<span class="s1">            * XESS Corporation &lt;info@xess.com&gt;</span>
<span class="s1">            ------------</span>
<span class="s1">            GUI, main collaborator and maintainer:</span>
<span class="s1">            * Hildo Guillardi Júnior https://github.com/hildogjr</span>
<span class="s1">            ------------</span>
<span class="s1">            Contributors:</span>
<span class="s1">            See https://github.com/hildogjr/KiCost/ for the full list.</span>
<span class="s1">            &#39;&#39;&#39;</span>
            <span class="n">credits</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;\n[\t ]+&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">credits</span><span class="p">)</span>  <span class="c1"># Remove leading whitespace</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_text_credits</span><span class="o">.</span><span class="n">SetValue</span><span class="p">(</span><span class="n">credits</span><span class="p">)</span>

        <span class="c1"># Recovery the last configurations used (found the folder of the file by the OS).</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">restore_properties</span><span class="p">()</span>

        <span class="c1"># Files in the history.</span>
        <span class="c1"># if not self.m_comboBox_files.IsListEmpty(): # If have some history, set to the last used file.</span>
        <span class="c1">#     self.m_comboBox_files.IsListEmpty(0)</span>

    <span class="c1"># ----------------------------------------------------------------------</span>
    <span class="k">def</span> <span class="nf">restore_properties</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39; @brief Restore the current proprieties of the graphical elements.&#39;&#39;&#39;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">configHandle</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">Config</span><span class="p">(</span><span class="n">CONFIG_FILE</span><span class="p">)</span>

            <span class="k">def</span> <span class="nf">str_to_wxpoint</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
                <span class="sd">&#39;&#39;&#39;Convert a string tuple into a  wxPoint.&#39;&#39;&#39;</span>
                <span class="n">p</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;\d+&#39;</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">wx</span><span class="o">.</span><span class="n">Point</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="nb">int</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>

            <span class="k">def</span> <span class="nf">str_to_wxsize</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
                <span class="sd">&#39;&#39;&#39;Convert a string tuple into a  wxRect.&#39;&#39;&#39;</span>
                <span class="n">p</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;\d+&#39;</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">wx</span><span class="o">.</span><span class="n">Size</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="nb">int</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>

            <span class="n">entryCount</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
                <span class="n">entry</span> <span class="o">=</span> <span class="n">configHandle</span><span class="o">.</span><span class="n">GetNextEntry</span><span class="p">(</span><span class="n">entryCount</span><span class="p">)</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">entry</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
                    <span class="k">break</span>
                <span class="n">entryCount</span> <span class="o">+=</span> <span class="mi">1</span>  <span class="c1"># Count the entry numbers and go to next one in next iteration.</span>
                <span class="n">entry</span> <span class="o">=</span> <span class="n">entry</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                <span class="n">entry_value</span> <span class="o">=</span> <span class="n">configHandle</span><span class="o">.</span><span class="n">Read</span><span class="p">(</span><span class="n">entry</span><span class="p">)</span>

                <span class="c1"># Resize and reposition the window frame.</span>
                <span class="k">if</span> <span class="n">entry</span> <span class="o">==</span> <span class="n">GUI_POSITION_ENTRY</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">SetPosition</span><span class="p">(</span><span class="n">str_to_wxpoint</span><span class="p">(</span><span class="n">entry_value</span><span class="p">))</span>
                    <span class="k">continue</span>
                <span class="k">elif</span> <span class="n">entry</span> <span class="o">==</span> <span class="n">GUI_SIZE_ENTRY</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">SetSize</span><span class="p">(</span><span class="n">str_to_wxsize</span><span class="p">(</span><span class="n">entry_value</span><span class="p">))</span>
                    <span class="k">continue</span>
                <span class="k">elif</span> <span class="n">entry</span> <span class="o">==</span> <span class="n">GUI_NEWS_MESSAGE_ENTRY</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">entry_value</span> <span class="o">==</span> <span class="s1">&#39;True&#39;</span><span class="p">:</span>
                        <span class="k">def</span> <span class="nf">wait_show_news_message</span><span class="p">():</span>
                            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">show_news_message</span><span class="p">():</span>
                                <span class="n">configHandle</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">Config</span><span class="p">(</span><span class="n">CONFIG_FILE</span><span class="p">)</span>
                                <span class="n">configHandle</span><span class="o">.</span><span class="n">Write</span><span class="p">(</span><span class="n">GUI_NEWS_MESSAGE_ENTRY</span><span class="p">,</span> <span class="s1">&#39;False&#39;</span><span class="p">)</span>  <span class="c1"># Doesn&#39;t show the message on next GUI startup.</span>
                        <span class="n">wx</span><span class="o">.</span><span class="n">CallAfter</span><span class="p">(</span><span class="n">wait_show_news_message</span><span class="p">)</span>
                    <span class="k">continue</span>

                <span class="k">try</span><span class="p">:</span>
                    <span class="n">wxElement_handle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">[</span><span class="n">entry</span><span class="p">]</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="n">wxElement_handle</span><span class="o">.</span><span class="n">IsEnabled</span><span class="p">():</span>
                        <span class="k">continue</span>  <span class="c1"># Not enabled controls have not to have the values restored.</span>
                    <span class="c1"># Find the wxPython element handle to access the methods.</span>
                    <span class="c1"># Each wxPython object have a specific parameter value</span>
                    <span class="c1"># to be saved and restored in the software initialization.</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">wxElement_handle</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">_core</span><span class="o">.</span><span class="n">TextCtrl</span><span class="p">):</span>
                        <span class="n">wxElement_handle</span><span class="o">.</span><span class="n">SetValue</span><span class="p">(</span><span class="n">entry_value</span><span class="p">)</span>
                    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">wxElement_handle</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">_core</span><span class="o">.</span><span class="n">CheckBox</span><span class="p">):</span>
                        <span class="n">wxElement_handle</span><span class="o">.</span><span class="n">SetValue</span><span class="p">((</span><span class="kc">True</span> <span class="k">if</span> <span class="n">entry_value</span> <span class="o">==</span> <span class="s1">&#39;True&#39;</span> <span class="k">else</span> <span class="kc">False</span><span class="p">))</span>
                    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">wxElement_handle</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">_core</span><span class="o">.</span><span class="n">CheckListBox</span><span class="p">):</span>
                        <span class="n">value</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="n">entry_value</span><span class="p">)</span>
                        <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">wxElement_handle</span><span class="o">.</span><span class="n">GetCount</span><span class="p">()):</span>  <span class="c1"># Reset all checked.</span>
                            <span class="n">wxElement_handle</span><span class="o">.</span><span class="n">Check</span><span class="p">(</span><span class="n">idx</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
                        <span class="k">for</span> <span class="n">dist_checked</span> <span class="ow">in</span> <span class="n">value</span><span class="p">:</span>  <span class="c1"># Check only the founded names.</span>
                            <span class="n">idx</span> <span class="o">=</span> <span class="n">wxElement_handle</span><span class="o">.</span><span class="n">FindString</span><span class="p">(</span><span class="n">dist_checked</span><span class="p">)</span>
                            <span class="k">if</span> <span class="n">idx</span> <span class="o">!=</span> <span class="n">wx</span><span class="o">.</span><span class="n">NOT_FOUND</span><span class="p">:</span>
                                <span class="n">wxElement_handle</span><span class="o">.</span><span class="n">Check</span><span class="p">(</span><span class="n">idx</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
                    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">wxElement_handle</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">_core</span><span class="o">.</span><span class="n">SpinCtrl</span><span class="p">):</span>
                        <span class="n">wxElement_handle</span><span class="o">.</span><span class="n">SetValue</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">entry_value</span><span class="p">))</span>
                    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">wxElement_handle</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">_core</span><span class="o">.</span><span class="n">SpinCtrlDouble</span><span class="p">):</span>
                        <span class="n">wxElement_handle</span><span class="o">.</span><span class="n">SetValue</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">entry_value</span><span class="p">))</span>
                    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">wxElement_handle</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">_core</span><span class="o">.</span><span class="n">ComboBox</span><span class="p">):</span>
                        <span class="k">if</span> <span class="n">entry</span> <span class="o">==</span> <span class="s1">&#39;m_comboBox_files&#39;</span><span class="p">:</span>
                            <span class="n">value</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="n">entry_value</span><span class="p">)</span>
                            <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">value</span><span class="p">:</span>
                                <span class="k">if</span> <span class="n">element</span><span class="p">:</span>
                                    <span class="n">wxElement_handle</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="n">element</span><span class="p">)</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">wxElement_handle</span><span class="o">.</span><span class="n">SetValue</span><span class="p">(</span><span class="n">entry_value</span><span class="p">)</span>
                    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">wxElement_handle</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">_core</span><span class="o">.</span><span class="n">ListBox</span><span class="p">):</span>
                        <span class="n">wxElement_handle</span><span class="o">.</span><span class="n">SetSelection</span><span class="p">(</span><span class="n">wxElement_handle</span><span class="o">.</span><span class="n">FindString</span><span class="p">(</span><span class="n">entry_value</span><span class="p">))</span>
                    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">wxElement_handle</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">_core</span><span class="o">.</span><span class="n">Notebook</span><span class="p">):</span>
                        <span class="n">wxElement_handle</span><span class="o">.</span><span class="n">SetSelection</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">entry_value</span><span class="p">))</span>
                    <span class="c1"># Others wxWidgets graphical elements with not saved configurations.</span>
                    <span class="c1"># elif isinstance(wxElement_handle, wx._core.):</span>
                    <span class="c1"># elif isinstance(wxElement_handle, wx._core.):configHandle</span>
                    <span class="c1"># elif isinstance(wxElement_handle, wx._core.StaticBitmap):</span>
                    <span class="c1"># elif isinstance(wxElement_handle, wx._core.Panel):</span>
                    <span class="c1"># elif isinstance(wxElement_handle, wx._core.Button):</span>
                    <span class="c1"># elif isinstance(wxElement_handle, wx._core.StaticText):</span>
                <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                    <span class="k">continue</span>

            <span class="k">del</span> <span class="n">configHandle</span>  <span class="c1"># Close the file / Windows registry sock.</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">debug_overview</span><span class="p">(</span><span class="s1">&#39;Configurations not recovered: &lt;&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;&gt;.&#39;</span><span class="p">)</span>

    <span class="c1"># ----------------------------------------------------------------------</span>
    <span class="k">def</span> <span class="nf">save_properties</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39; @brief Save the current proprieties of the graphical elements.&#39;&#39;&#39;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">configHandle</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">Config</span><span class="p">(</span><span class="n">CONFIG_FILE</span><span class="p">)</span>

            <span class="c1"># Save position and size.</span>
            <span class="n">configHandle</span><span class="o">.</span><span class="n">Write</span><span class="p">(</span><span class="n">GUI_POSITION_ENTRY</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">GetPosition</span><span class="p">()))</span>
            <span class="n">configHandle</span><span class="o">.</span><span class="n">Write</span><span class="p">(</span><span class="n">GUI_SIZE_ENTRY</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">GetSize</span><span class="p">()))</span>

            <span class="c1"># Sweep all elements in `self()` to find the graphical ones</span>
            <span class="c1"># instance of the wxPython and salve the specific configuration.</span>
            <span class="k">for</span> <span class="n">wxElement_name</span><span class="p">,</span> <span class="n">wxElement_handle</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="c1"># Each wxPython object have a specific parameter value</span>
                    <span class="c1"># to be saved and restored in the software initialization.</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">wxElement_handle</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">_core</span><span class="o">.</span><span class="n">TextCtrl</span><span class="p">)</span> <span class="ow">and</span> <span class="n">wxElement_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;m_textCtrl_messages&#39;</span><span class="p">,</span> <span class="s1">&#39;m_text_credits&#39;</span><span class="p">,</span> <span class="s1">&#39;m_text_saveas&#39;</span><span class="p">]:</span>
                        <span class="c1"># Save each TextCtrl (TextBox) that is not the status messages or credits.</span>
                        <span class="n">configHandle</span><span class="o">.</span><span class="n">Write</span><span class="p">(</span><span class="n">wxElement_name</span><span class="p">,</span> <span class="n">wxElement_handle</span><span class="o">.</span><span class="n">GetValue</span><span class="p">())</span>
                    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">wxElement_handle</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">_core</span><span class="o">.</span><span class="n">CheckBox</span><span class="p">):</span>
                        <span class="n">configHandle</span><span class="o">.</span><span class="n">Write</span><span class="p">(</span><span class="n">wxElement_name</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;True&#39;</span> <span class="k">if</span> <span class="n">wxElement_handle</span><span class="o">.</span><span class="n">GetValue</span><span class="p">()</span> <span class="k">else</span> <span class="s1">&#39;False&#39;</span><span class="p">))</span>
                    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">wxElement_handle</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">_core</span><span class="o">.</span><span class="n">CheckListBox</span><span class="p">):</span>
                        <span class="c1"># value = [wxElement_handle.GetString(idx) for idx in wxElement_handle.GetCheckedItems()] # Only valid on wxPy4.</span>
                        <span class="n">value</span> <span class="o">=</span> <span class="p">[</span><span class="n">wxElement_handle</span><span class="o">.</span><span class="n">GetString</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">wxElement_handle</span><span class="o">.</span><span class="n">GetCount</span><span class="p">())</span> <span class="k">if</span> <span class="n">wxElement_handle</span><span class="o">.</span><span class="n">IsChecked</span><span class="p">(</span><span class="n">i</span><span class="p">)]</span>
                        <span class="n">configHandle</span><span class="o">.</span><span class="n">Write</span><span class="p">(</span><span class="n">wxElement_name</span><span class="p">,</span> <span class="s1">&#39;,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">value</span><span class="p">))</span>
                    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">wxElement_handle</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">_core</span><span class="o">.</span><span class="n">SpinCtrl</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">wxElement_handle</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">_core</span><span class="o">.</span><span class="n">SpinCtrlDouble</span><span class="p">):</span>
                        <span class="n">configHandle</span><span class="o">.</span><span class="n">Write</span><span class="p">(</span><span class="n">wxElement_name</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">wxElement_handle</span><span class="o">.</span><span class="n">GetValue</span><span class="p">()))</span>
                    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">wxElement_handle</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">_core</span><span class="o">.</span><span class="n">ComboBox</span><span class="p">):</span>
                        <span class="k">if</span> <span class="n">wxElement_name</span> <span class="o">==</span> <span class="s1">&#39;m_comboBox_files&#39;</span><span class="p">:</span>  <span class="c1"># Save the file history.</span>
                            <span class="n">value</span> <span class="o">=</span> <span class="p">[</span><span class="n">wxElement_handle</span><span class="o">.</span><span class="n">GetString</span><span class="p">(</span><span class="n">idx</span><span class="p">)</span> <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">wxElement_handle</span><span class="o">.</span><span class="n">GetCount</span><span class="p">())]</span>
                            <span class="n">configHandle</span><span class="o">.</span><span class="n">Write</span><span class="p">(</span><span class="n">wxElement_name</span><span class="p">,</span> <span class="s1">&#39;,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">value</span><span class="p">))</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">configHandle</span><span class="o">.</span><span class="n">Write</span><span class="p">(</span><span class="n">wxElement_name</span><span class="p">,</span> <span class="n">wxElement_handle</span><span class="o">.</span><span class="n">GetValue</span><span class="p">())</span>
                    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">wxElement_handle</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">_core</span><span class="o">.</span><span class="n">ListBox</span><span class="p">):</span>
                        <span class="n">configHandle</span><span class="o">.</span><span class="n">Write</span><span class="p">(</span><span class="n">wxElement_name</span><span class="p">,</span> <span class="n">wxElement_handle</span><span class="o">.</span><span class="n">GetStringSelection</span><span class="p">())</span>
                    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">wxElement_handle</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">_core</span><span class="o">.</span><span class="n">Notebook</span><span class="p">):</span>
                        <span class="n">configHandle</span><span class="o">.</span><span class="n">Write</span><span class="p">(</span><span class="n">wxElement_name</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">wxElement_handle</span><span class="o">.</span><span class="n">GetSelection</span><span class="p">()))</span>
                    <span class="c1"># Others wxWidgets graphical elements with not saved configurations.</span>
                    <span class="c1"># elif isinstance(wxElement_handle, wx._core.):configHandle</span>
                    <span class="c1"># elif isinstance(wxElement_handle, wx._core.StaticBitmap):</span>
                    <span class="c1"># elif isinstance(wxElement_handle, wx._core.Panel):</span>
                    <span class="c1"># elif isinstance(wxElement_handle, wx._core.Button):</span>
                    <span class="c1"># elif isinstance(wxElement_handle, wx._core.StaticText):</span>
                <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                    <span class="k">continue</span>

            <span class="k">del</span> <span class="n">configHandle</span>  <span class="c1"># Close the file / Windows registry sock.</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">debug_overview</span><span class="p">(</span><span class="s1">&#39;Configurations not saved: &lt;&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;&gt;.&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">show_news_message</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Shows a message bos if the news of the last version installed.&#39;&#39;&#39;</span>
        <span class="n">history_file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">kicostPath</span><span class="p">,</span> <span class="s1">&#39;HISTORY.rst&#39;</span><span class="p">))</span>
        <span class="n">history</span> <span class="o">=</span> <span class="n">history_file</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
        <span class="n">history_file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="n">search_news</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;History\s+[\=\-\_]+\s+(?P&lt;version&gt;[\w\.]+)\s*\((?P&lt;data&gt;.+)\)\s+[\=\-\_]+\s+(?P&lt;news&gt;(?:\n|.)*?)\s+[\d\.]+&#39;</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">IGNORECASE</span><span class="p">)</span>
        <span class="n">news</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">search_news</span><span class="p">,</span> <span class="n">history</span><span class="p">)</span>
        <span class="n">dlg</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">MessageDialog</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                               <span class="n">news</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="s1">&#39;news&#39;</span><span class="p">),</span>
                               <span class="s1">&#39;NEWS of KiCost v</span><span class="si">{v}</span><span class="s1"> release from </span><span class="si">{d}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">v</span><span class="o">=</span><span class="n">news</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="s1">&#39;version&#39;</span><span class="p">),</span> <span class="n">d</span><span class="o">=</span><span class="n">news</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="s1">&#39;data&#39;</span><span class="p">)),</span>
                               <span class="n">wx</span><span class="o">.</span><span class="n">OK</span> <span class="o">|</span> <span class="n">wx</span><span class="o">.</span><span class="n">ICON_INFORMATION</span><span class="p">)</span>
        <span class="n">dlg</span><span class="o">.</span><span class="n">ShowModal</span><span class="p">()</span>
        <span class="n">dlg</span><span class="o">.</span><span class="n">Destroy</span><span class="p">()</span>
        <span class="k">return</span> <span class="kc">True</span>


<span class="c1">#######################################################################</span>

<span class="k">class</span> <span class="nc">GUI_Stream</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">aWxTextCtrl</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">area</span> <span class="o">=</span> <span class="n">aWxTextCtrl</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cyan</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">TextAttr</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">CYAN</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">white</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">TextAttr</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">WHITE</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">yellow</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">TextAttr</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">YELLOW</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">red</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">TextAttr</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">RED</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cur</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">white</span>

    <span class="k">def</span> <span class="nf">write</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">msg</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">msg</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;DEBUG:&#39;</span><span class="p">):</span>
            <span class="n">color</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cyan</span>
        <span class="k">elif</span> <span class="n">msg</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;WARNING:&#39;</span><span class="p">):</span>
            <span class="n">color</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">yellow</span>
        <span class="k">elif</span> <span class="n">msg</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;ERROR:&#39;</span><span class="p">):</span>
            <span class="n">color</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">red</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">color</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">white</span>
        <span class="k">if</span> <span class="n">color</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cur</span><span class="p">:</span>
            <span class="n">wx</span><span class="o">.</span><span class="n">CallAfter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">area</span><span class="o">.</span><span class="n">SetDefaultStyle</span><span class="p">,</span> <span class="n">color</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">cur</span> <span class="o">=</span> <span class="n">color</span>
        <span class="c1"># Let the main thread update the message</span>
        <span class="n">wx</span><span class="o">.</span><span class="n">CallAfter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">area</span><span class="o">.</span><span class="n">AppendText</span><span class="p">,</span> <span class="n">msg</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">flush</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">__stderr__</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">isatty</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="kc">False</span>


<span class="k">class</span> <span class="nc">ProgressGUI</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="n">frame</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">total</span><span class="p">,</span> <span class="n">logger</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">total</span> <span class="o">=</span> <span class="n">total</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cur</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cur</span> <span class="o">+=</span> <span class="n">val</span>
        <span class="n">wx</span><span class="o">.</span><span class="n">CallAfter</span><span class="p">(</span><span class="n">ProgressGUI</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">m_gauge_process</span><span class="o">.</span><span class="n">SetValue</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cur</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">total</span><span class="o">*</span><span class="mi">100</span><span class="p">))</span>  <span class="c1"># Porcentual</span>
        <span class="n">wx</span><span class="o">.</span><span class="n">CallAfter</span><span class="p">(</span><span class="n">ProgressGUI</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">m_staticText_progressInfo</span><span class="o">.</span><span class="n">SetLabel</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1">/</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cur</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">total</span><span class="p">))</span>  <span class="c1"># Eta.</span>

    <span class="k">def</span> <span class="nf">close</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">pass</span>


<div class="viewcode-block" id="kicost_gui"><a class="viewcode-back" href="../../kicost.html#kicost.kicost_gui.kicost_gui">[docs]</a><span class="k">def</span> <span class="nf">kicost_gui</span><span class="p">(</span><span class="n">force_en_us</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">files</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39; @brief Load the graphical interface.</span>
<span class="sd">        @param String file file names or list.</span>
<span class="sd">        (it will be used for plugin implementation on future KiCad6-Eeschema).</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">app</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">App</span><span class="p">(</span><span class="n">redirect</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">loc</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">Locale</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">LANGUAGE_DEFAULT</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">force_en_us</span> <span class="k">else</span> <span class="n">wx</span><span class="o">.</span><span class="n">LANGUAGE_ENGLISH_US</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">loc</span><span class="o">.</span><span class="n">IsOk</span><span class="p">():</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">force_en_us</span><span class="p">:</span>
            <span class="n">warning</span><span class="p">(</span><span class="n">W_LOCFAIL</span><span class="p">,</span> <span class="s2">&quot;Failed to set the default locale, try using `--force_en_us`&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">warning</span><span class="p">(</span><span class="n">W_LOCFAIL</span><span class="p">,</span> <span class="s2">&quot;`--force_en_us` doesn&#39;t seem to help&quot;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="ow">not</span> <span class="n">loc</span><span class="o">.</span><span class="n">GetLocale</span><span class="p">()</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">loc</span><span class="o">.</span><span class="n">GetName</span><span class="p">():</span>
        <span class="n">warning</span><span class="p">(</span><span class="n">W_LOCFAIL</span><span class="p">,</span> <span class="s2">&quot;Unsupported locale&quot;</span><span class="o">+</span><span class="p">(</span><span class="s2">&quot;, try using `--force_en_us`&quot;</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">force_en_us</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">sys_loc_name</span> <span class="o">=</span> <span class="n">locale</span><span class="o">.</span><span class="n">getlocale</span><span class="p">()</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="n">warning</span><span class="p">(</span><span class="n">W_LOCFAIL</span><span class="p">,</span> <span class="s2">&quot;Unsupported locale (python)&quot;</span><span class="o">+</span><span class="p">(</span><span class="s2">&quot;, try using `--force_en_us`&quot;</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">force_en_us</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span><span class="p">))</span>
            <span class="n">sys_loc_name</span> <span class="o">=</span> <span class="s1">&#39;unsupported&#39;</span>
        <span class="n">debug_general</span><span class="p">(</span><span class="s1">&#39;wxWidgets locale </span><span class="si">{}</span><span class="s1"> (</span><span class="si">{}</span><span class="s1">) system: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loc</span><span class="o">.</span><span class="n">GetLocale</span><span class="p">(),</span> <span class="n">loc</span><span class="o">.</span><span class="n">GetName</span><span class="p">(),</span> <span class="n">sys_loc_name</span><span class="p">))</span>
    <span class="n">frame</span> <span class="o">=</span> <span class="n">formKiCost</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
    <span class="c1"># Use the GUI for progress</span>
    <span class="n">set_distributors_progress</span><span class="p">(</span><span class="n">ProgressGUI</span><span class="p">)</span>
    <span class="n">ProgressGUI</span><span class="o">.</span><span class="n">frame</span> <span class="o">=</span> <span class="n">frame</span>
    <span class="c1"># Redirect the logging system to the GUI area</span>
    <span class="n">logger_stream</span> <span class="o">=</span> <span class="n">GUI_Stream</span><span class="p">(</span><span class="n">frame</span><span class="o">.</span><span class="n">m_textCtrl_messages</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">handler</span> <span class="ow">in</span> <span class="n">get_logger</span><span class="p">()</span><span class="o">.</span><span class="n">handlers</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">py_2</span><span class="p">:</span>
            <span class="n">handler</span><span class="o">.</span><span class="n">stream</span> <span class="o">=</span> <span class="n">logger_stream</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">handler</span><span class="o">.</span><span class="n">setStream</span><span class="p">(</span><span class="n">logger_stream</span><span class="p">)</span>
        <span class="c1"># Reset the formatter so it realizes that we aren&#39;t using a terminal</span>
        <span class="n">handler</span><span class="o">.</span><span class="n">setFormatter</span><span class="p">(</span><span class="n">CustomFormatter</span><span class="p">(</span><span class="n">logger_stream</span><span class="p">))</span>

    <span class="k">if</span> <span class="n">files</span><span class="p">:</span>
        <span class="n">frame</span><span class="o">.</span><span class="n">m_comboBox_files</span><span class="o">.</span><span class="n">SetValue</span><span class="p">(</span><span class="n">SEP_FILES</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">files</span><span class="p">))</span>
        <span class="n">frame</span><span class="o">.</span><span class="n">updateOutputFilename</span><span class="p">()</span>

    <span class="n">frame</span><span class="o">.</span><span class="n">Show</span><span class="p">()</span>
    <span class="n">app</span><span class="o">.</span><span class="n">MainLoop</span><span class="p">()</span>

    <span class="c1"># Restore the channel print output to terminal.</span>
    <span class="c1"># Necessary if KiCost was called by other software?</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">__stderr__</span>
    <span class="k">for</span> <span class="n">handler</span> <span class="ow">in</span> <span class="n">get_logger</span><span class="p">()</span><span class="o">.</span><span class="n">handlers</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">py_2</span><span class="p">:</span>
            <span class="n">handler</span><span class="o">.</span><span class="n">stream</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">handler</span><span class="o">.</span><span class="n">setStream</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="p">)</span>
        <span class="n">handler</span><span class="o">.</span><span class="n">setFormatter</span><span class="p">(</span><span class="n">CustomFormatter</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="p">))</span></div>


<span class="c1"># SET: This is half imlemented, the m_textCtrlextracmd isn&#39;t there</span>
<span class="c1"># def kicost_gui_runterminal(args):</span>
<span class="c1">#     &#39;&#39;&#39; @brief Execute the `fileName` under KiCost loading the</span>
<span class="c1">#         graphical interface.</span>
<span class="c1">#</span>
<span class="c1">#         The difference of the normal execution is that the log and</span>
<span class="c1">#         process bar is not redirected to the GUI, staying on terminal.</span>
<span class="c1">#</span>
<span class="c1">#         @param List of the file name.</span>
<span class="c1">#     &#39;&#39;&#39;</span>
<span class="c1">#     app = wx.App(redirect=False)</span>
<span class="c1">#     frame = formKiCost(None)</span>
<span class="c1">#</span>
<span class="c1">#     files = args.input</span>
<span class="c1">#     if files:</span>
<span class="c1">#         frame.m_comboBox_files.SetValue(SEP_FILES.join(files))</span>
<span class="c1">#     frame.updateOutputFilename()</span>
<span class="c1">#</span>
<span class="c1">#     options_cmd = &#39;&#39;</span>
<span class="c1">#     for k_a in list(args.__dict__.keys()):</span>
<span class="c1">#         values = args.__dict__[k_a]</span>
<span class="c1">#         if k_a == &#39;input&#39; or k_a == &#39;user&#39; or k_a == &#39;guide&#39; or k_a == &#39;help&#39;:</span>
<span class="c1">#             pass</span>
<span class="c1">#         elif isinstance(values, bool) and values:</span>
<span class="c1">#             options_cmd += &#39; --&#39; + k_a</span>
<span class="c1">#         elif isinstance(values, float) or isinstance(values, int) and values:</span>
<span class="c1">#             options_cmd += &#39; --&#39; + k_a + &#39; &quot;&#39; + str(values) + &#39;&quot;&#39;</span>
<span class="c1">#         elif isinstance(values, list) and values:</span>
<span class="c1">#             print(values)</span>
<span class="c1">#             if isinstance(values[0], int):</span>
<span class="c1">#                 values = [str(v) for v in values]</span>
<span class="c1">#             else:</span>
<span class="c1">#                 values = [&#39;&quot;&#39;+str(v)+&#39;&quot;&#39; for v in values]</span>
<span class="c1">#             print(values)</span>
<span class="c1">#             options_cmd += &#39; --&#39; + k_a + &#39; &#39; + &#39; &#39;.join(values)</span>
<span class="c1">#             print(options_cmd)</span>
<span class="c1">#         # else values:</span>
<span class="c1">#         #     options_cmd += &#39;--&#39; + k_a + &#39; &#39;.join(values)</span>
<span class="c1">#</span>
<span class="c1">#     frame.m_textCtrlextracmd.SetValue(options_cmd)</span>
<span class="c1">#</span>
<span class="c1">#     frame.updateEDAselection()</span>
<span class="c1">#     frame.run()</span>
</pre></div>

            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">kicost 1.1.12 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" >Module code</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">kicost.kicost_gui</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2015, XESS Corporation.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 3.4.3.
    </div>
  </body>
</html>